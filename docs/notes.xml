<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Homophony</title>
<link>https://homophony.quest/notes.html</link>
<atom:link href="https://homophony.quest/notes.xml" rel="self" type="application/rss+xml"/>
<description>Music blog for motivation to play more music</description>
<image>
<url>https://homophony.quest/images/cover.jpg</url>
<title>Homophony</title>
<link>https://homophony.quest/notes.html</link>
</image>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Fri, 27 Jun 2025 04:00:00 GMT</lastBuildDate>
<item>
  <title>Headless dirtywave m8</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/63_6_27_25_headless_m8/</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/63_6_27_25_headless_m8/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>m8 dirtywave manual</p>
</div></div><p>Haven’t posted here in way too long.</p>
<p>Recently got turned onto the <a href="https://dirtywave.com">dirtywave m8 tracker</a>, and it’s blowing me away. Amazing software and device.</p>
<p>Just collecting random bits and pieces on the m8 here for my own reference. If I get round to it, I may post some tricks as I explore this thing.</p>
<section id="m8" class="level1">
<h1>m8</h1>
<p>Still waiting to buy a real m8 (mark II)…they’re all sold out.</p>
<p>Amazingly, the software is free and can be loaded onto a teensy, so I did all of that in advance of getting in an m8 pre-order.</p>
</section>
<section id="lsdj-anbernic" class="level1">
<h1>lsdj + anbernic</h1>
<p>A week or two ago I got started with lsdj, which m8 is based on.</p>
<p>Steps:</p>
<ol type="1">
<li><p>Bought an <a href="https://anbernic.com/products/rg-40xxv">anbernic game-boy</a> RG 40XXV. Had I known at that time that I would be running a teensy with this, I would have got one of the ones with two usb-c ports (one for charging. oh well)</p></li>
<li><p>Installed <a href="https://www.littlesounddj.com/lsd/index.php">lsdj</a></p></li>
<li><p>Had loads of fun</p></li>
</ol>
<p>So many helpful youtube videos out there to get started, and starting with lsdj made the switch to m8 nearly seamless</p>
</section>
<section id="headless-m8-with-teensy" class="level1">
<h1>headless m8 with teensy</h1>
<p>Not sure I can remember all the steps, but followed the directions on github, <a href="https://github.com/Dirtywave/M8HeadlessFirmware" class="uri">https://github.com/Dirtywave/M8HeadlessFirmware</a>.</p>
<ol type="1">
<li><p>Bought a teensy, two micro sd cards, and a short cable</p></li>
<li><p>Installed knulli on the anbernic <a href="https://github.com/jamesMcMeex/m8c-rg35xx-knulli" class="uri">https://github.com/jamesMcMeex/m8c-rg35xx-knulli</a></p></li>
<li><p>followed this <a href="https://www.youtube.com/watch?v=79USMsdRxhw">advice from Auodafe on youtube</a>.</p></li>
</ol>
</section>
<section id="m8-links" class="level1">
<h1>m8 links</h1>
<ul>
<li><a href="https://github.com/v3rm0n/awesome-m8?tab=readme-ov-file">awesome m8</a></li>
<li><a href="https://www.youtube.com/watch?v=-0QVcb4YwG8">ideas for programming euclidean triggers</a></li>
<li><a href="https://bit-101.com/blog/posts/2025-04-22/fm-synth-chords-on-m8/">chords using the fm synth and tables</a></li>
<li><a href="https://www.youtube.com/watch?v=2OgxO4W8oJk">good intro to tables on m8</a></li>
</ul>
</section>
<section id="jam" class="level1">
<h1>jam</h1>
<p>A first quick jam. Drums are a chopped up sample with some euclidean triggers and a bit of randomization, same with the pads and bass, all m8. Then a rhodes jam over top.</p>
<p><audio controls=""> <source src="rhodes_m8.mp3" type="audio/wav"> </audio></p>
<p>I was impressed with how much variation in the drums I could achieve with the following setup.</p>
<p><a href="images/m8_drums.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://homophony.quest/blog/63_6_27_25_headless_m8/images/m8_drums.png" class="img-fluid"></a></p>
<p>C-1 is triggering a sample that I sliced up into 16 parts. The STA command allows the starting point (slice in the sample) to vary every bar. The RNL command randomizes the value send to starting slice (it should start anywhere from slice 1 - F…16 in hexadeximal).</p>
<p>I had previously programmed all of the E tables to contain euclidean rhythms. So, E3 has 3 of 16 possible triggers, E4 has 4 of 16 possible triggers, etc.</p>
<p>As a result, the sample triggered by C-1 is retriggered following the euclidean triggers in the table, in this case E6 (6 beats our of 16). But, in addition, the RND command allows a random value between 0 and 3 to be added to the 6 value above, which means that euclidean table is sampled from between E6 and E9 every bar. All of that adds up to some decent “generative” variation for the drum part.</p>


</section>

 ]]></description>
  <category>tracker</category>
  <category>m8</category>
  <guid>https://homophony.quest/blog/63_6_27_25_headless_m8/</guid>
  <pubDate>Fri, 27 Jun 2025 04:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/63_6_27_25_headless_m8/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Notes on chopping beats with the dirtywave m8 (headless)</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/64_6_28_25_chopping_beats_m8/</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/64_6_28_25_chopping_beats_m8/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>m8 dirtywave manual</p>
</div></div><p>This is unlikely to be an organized post…notes to self about chopping beats on the m8, which seems to work mostly as I expect, but with several things I don’t expect. Plus, I need to practice.</p>
<section id="chopping-with-repitch" class="level1">
<h1>chopping with repitch</h1>
<p><a href="images/repitch chopper.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://homophony.quest/blog/64_6_28_25_chopping_beats_m8/images/repitch chopper.png" class="img-fluid"></a></p>
<ol type="1">
<li><p>Chop the sample so it is a known number of bars. This one was 4 bars.</p></li>
<li><p>Slice the sample (this one had 32 slices)</p></li>
<li><p>Choose the number of slices in the instrument panel (32)</p></li>
<li><p>Set play to repitch. This will cause each slice to loop. Set the “Steps” to the number of bars in the sample (4 bars)</p></li>
<li><p>Use an AHD envelope, set the hold to the slice length (in this case it is two steps)</p></li>
</ol>
<p>The first slice would be C-1 in the phrase window. To faithfully recreate the beat, enter incrementing notes from C-1 every other step.</p>
<p>I did that, then highlighted the notes and experimented with transposing them to find something I liked. Then added a few extra triggers, and set the notes to random (+8) for a little bit of variation. Copied this phrase a few times in the chain menu, made the last one have even more random stuff for a fill.</p>
<p><audio controls=""> <source src="repitch_chop.mp3" type="audio/wav"> </audio></p>
</section>
<section id="try-time-stretching" class="level1">
<h1>try time stretching</h1>
<ul>
<li><p><a href="https://www.youtube.com/watch?v=keOTVDfgPtU">M8 Sample Time Stretching Deep Dive</a></p></li>
<li><p><a href="https://www.youtube.com/watch?v=Bfa6XMT3MW0">m8 - Old School Time Stretching Technique</a></p></li>
</ul>
<p>Got it working.</p>
<p><a href="images/timestretch chopper.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://homophony.quest/blog/64_6_28_25_chopping_beats_m8/images/timestretch chopper.png" class="img-fluid"></a></p>
<ul>
<li><p>Crop the sample to X known bars.</p></li>
<li><p>Set play to FWDLOOP</p></li>
<li><p>Use an LFO with destination Loop ST. Ramp up, retrig. Set the freq to the length of the sample (in this case 10 is one bar, and the sample is one bar). This causes the loop start position to increase linearly as the lfo rises from 0 to 100%</p></li>
<li><p>In the instrument screen I fiddled with LENGTH and that helped smooth out artifacts. That’s basically it, adjust tempo and it seems to be working</p></li>
<li><p>C-4 was the base note. This triggers the sample.</p></li>
<li><p>Use STA to change where the sample starts to play</p></li>
<li><p>And some randomness to those starting points.</p></li>
<li><p>Pitching C-4 up or down does change the pitch, but not the tempo, nice</p></li>
</ul>
</section>
<section id="playing-random-notes-from-a-select-pool-of-notes-using-tables" class="level1">
<h1>Playing random notes from a select pool of notes using tables</h1>
<p>Quick experiment. Challenge was to change a note value and replace it with a randomly chosen note from a specified pool of notes.</p>
<p>It’s possible to do something like the above by setting a scale, but scales don’t appear to work with tables.</p>
<p>This table begins with a hop command to jump to row 4. Rows 4 to 7 have retriggers programmed for 2nd, major 3rd, 4th, and 5th. The RNL command randomly adds 0-3 (I think it’s 0-3 and not 1-3?) to the hop, and the KIL command prevent the table from incrementing.</p>
<p>The basic result is achieved and every time the note plays in the phrase, it is randomly transposed by one of these four values. This little trick will come in handy later for other stuff where I want some variation, but also want to limit the variation to specific notes or, in the case of chopping beats, specific slices or starting points or whatever.</p>
<p><a href="images/table_sample.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://homophony.quest/blog/64_6_28_25_chopping_beats_m8/images/table_sample.png" class="img-fluid"></a></p>


</section>

 ]]></description>
  <category>tracker</category>
  <category>m8</category>
  <guid>https://homophony.quest/blog/64_6_28_25_chopping_beats_m8/</guid>
  <pubDate>Fri, 27 Jun 2025 04:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/64_6_28_25_chopping_beats_m8/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Fixing up my Sears Kawai 26133 electric guitar</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/62_8_6_24_kawai_guitar/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"practicing synthesizer on a beach. the sunset is a synthesizer. The moon in the sky is a synthesizer. The trees are made of synthesizers. The ocean is music. colorful. 3d."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/62_8_6_24_kawai_guitar/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Three guitars with problems sat on wall.</p>
</div></div><p>All three of these guitars have issues. The one in the middle has the most issues for the longest period of time.</p>
<p>I can’t remember when I first picked this up, say 14 or 16, or something like that. For the longest time I had no idea what kind of guitar it was (no label or model number anywhere).</p>
<p>It never really worked that well. The action was fine. It looked neat. It crackled. It only made sound when all the faders were in one direction. Pieces chipped off. One day it stopped working altogether. It’s been broken and hanging around for years.</p>
<section id="finding-similar-guitars-online" class="level2">
<h2 class="anchored" data-anchor-id="finding-similar-guitars-online">Finding similar guitars online</h2>
<p>Found some info:</p>
<p>Seems like this could be a Sears Kawai 26133 (or some version of this).</p>
<p><a href="https://reverb.com/item/36471562-vintage-sears-kawai-26133-1969-sunburst" class="uri">https://reverb.com/item/36471562-vintage-sears-kawai-26133-1969-sunburst</a></p>
<p>Saturn Guitar circuits:</p>
<p><a href="https://www.saturn-guitar-circuits.com" class="uri">https://www.saturn-guitar-circuits.com</a></p>
</section>
<section id="nice-example-of-repairing-a-similar-guitar" class="level2">
<h2 class="anchored" data-anchor-id="nice-example-of-repairing-a-similar-guitar">nice example of repairing a similar guitar</h2>
<p><a href="https://www.youtube.com/watch?v=OebpmmNFJ6Q&amp;t=1208s" class="uri">https://www.youtube.com/watch?v=OebpmmNFJ6Q&amp;t=1208s</a></p>
</section>
<section id="what-i-did-so-far" class="level2">
<h2 class="anchored" data-anchor-id="what-i-did-so-far">What I did so far</h2>
<p>Not much</p>
<ul>
<li>Some light resoldering. The neck pick-up was disconnected from one of the faders</li>
<li>cleaned the neck, looks much better</li>
<li>restrung</li>
<li>works a bit better</li>
<li>waiting on circuit cleaner</li>
<li>probably need to do a bunch more</li>
</ul>
</section>
<section id="tone" class="level2">
<h2 class="anchored" data-anchor-id="tone">Tone</h2>
<p>Interesting surf clunker tone. Treble is super muffled. Need to investigate more.</p>
</section>
<section id="contact-cleaner-to-the-rescue" class="level2">
<h2 class="anchored" data-anchor-id="contact-cleaner-to-the-rescue">Contact cleaner to the rescue</h2>
<p>I should have misted contact cleaner into the faders and switches years ago. The pickups weren’t the problem.</p>
<p>Treble is back.</p>
<p>Basically, more or less playable now.</p>
</section>
<section id="to-do" class="level2">
<h2 class="anchored" data-anchor-id="to-do">to do</h2>
<p>Refret… Maybe redo the switches and sliders</p>


</section>

 ]]></description>
  <category>guitars</category>
  <category>gear</category>
  <category>repair</category>
  <guid>https://homophony.quest/blog/62_8_6_24_kawai_guitar/</guid>
  <pubDate>Tue, 06 Aug 2024 04:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/62_8_6_24_kawai_guitar/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Boss rc-505 mk ii looper</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/60_4_13_24_weekly/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messy room full of synthesizers. wires going everywhere. musical chaos. modular synthesizers everywhere. cluttered music room of synthesizers."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/60_4_13_24_weekly/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Boss rc-505 mk ii looper</p>
</div></div><p>This thing was supposed to be delivered on a Sunday, but it came early, so I got to spend most of Saturday playing around with it.</p>
<p>First impressions are that this is TOO MUCH FUN.</p>
<p>There is a huge amount of possibilities to this device and was expecting to have to be overwhelmed by figuring out how to set it up just the way I wanted it to work. Surprise, the default settings were great, and pretty much spot on with what I would use this for.</p>
<p>I’m sure there will be other things to try, and my plan is to make random notes to self here.</p>
<section id="copy-settings-from-one-memory-to-another" class="level2">
<h2 class="anchored" data-anchor-id="copy-settings-from-one-memory-to-another">Copy settings from one memory to another</h2>
<p>I set up a midi foot pedal (midi captain) as a trigger option for the first track. Took a bit of fiddling, but got that working. Then, after I saved a loop session to the first memory and scrolled over to the second memory, the midi trigger wasn’t working. It seems that each memory saves all of the settings. I had changed the settings from default for the first memory, and I had to change them again for the second memory.</p>
<p>I’m not sure yet if the defaults can be changed and applied across all memories? But, it is possible to copy/paste one memory to another. So, I guess I would make a memory with a settings template, and then copy/paste it across a bunch of memories.</p>
<p>To copy/paste, apparently this is the same as “write”, but, you would turn the encoder for memory and save the current one to a different number.</p>
<p><a href="https://www.reddit.com/r/LoopArtists/comments/oyk51f/boss_rc505_apply_memory_settings_to_all_memories/" class="uri">https://www.reddit.com/r/LoopArtists/comments/oyk51f/boss_rc505_apply_memory_settings_to_all_memories/</a></p>
<ul>
<li>got this working now, it’s totally easy. I still need to learn which settings are actually global. Otherwise, it’s fast to take any memory, write it to another location, and then clear the tracks (and keep the settings)</li>
</ul>
</section>
<section id="sounds-great" class="level2">
<h2 class="anchored" data-anchor-id="sounds-great">Sounds great</h2>
<p>I’m really impressed with the sound quality. This is all very subjective and also determined by my other gear, but I have not had the same experience with some other similar devices. For example, I have an MPC Live, and although it is very good for some things, I did not like how audio sounded playing through it. Some instruments sounded lifeless and muted by comparison to the main system. This looper though…the A/D converters are apparently very good. When everything is clean and passing through, it sounds great, almost invisible. And, I’m OK with the general character of the other stuff like the compressor etc., or I’ll just turn it off.</p>
</section>
<section id="guitar-pedal-multi-fx" class="level2">
<h2 class="anchored" data-anchor-id="guitar-pedal-multi-fx">Guitar pedal multi fx</h2>
<p>I wasn’t expecting the FX to be so use-able, especially the live input FX. I feel like I got a bunch of guitar pedals for free here. Damn, OK, yes.</p>
</section>
<section id="snappy" class="level2">
<h2 class="anchored" data-anchor-id="snappy">Snappy</h2>
<p>So far, no latency problems. none. wow.</p>
</section>
<section id="fun-machine-with-constraints" class="level2">
<h2 class="anchored" data-anchor-id="fun-machine-with-constraints">Fun machine with constraints</h2>
<p>The gear situation at hand can suggest or afford workflows. These days, with a bunch of gear and a laptop, there are many possible workflows. It’s fun to explore them. Sometimes it’s nice to work within the constraints of a particular device. So far, this is one of those times.</p>
</section>
<section id="freeze" class="level2">
<h2 class="anchored" data-anchor-id="freeze">Freeze</h2>
<p>There is a decent freeze effect in here. I have a midi pedal, I should set it up to make the freeze effect happen when I press a foot pedal. Goals for the future.</p>
</section>
<section id="incrementing-memory-foot-switch" class="level2">
<h2 class="anchored" data-anchor-id="incrementing-memory-foot-switch">Incrementing memory foot switch</h2>
<p>Haven’t tried this yet, but it is apparently possible in a song context. My experience with loopers before was getting stuck in a loop, and being able to switch between parts is a nice option.</p>
<p>Tried this out a little bit…sending program changes from the midi captain changes the memory.</p>
<p>Warning…Memories need to be saved, so if they are not saved it is very easy to switch between a memory and accidentally wipe the one you were on.</p>
</section>
<section id="thinking-through-some-setup-options-with-other-gear" class="level2">
<h2 class="anchored" data-anchor-id="thinking-through-some-setup-options-with-other-gear">Thinking through some setup options with other gear</h2>
<section id="program-changes-mpc-live" class="level3">
<h3 class="anchored" data-anchor-id="program-changes-mpc-live">Program changes, MPC live</h3>
<p>Current setup:</p>
<p>Midi captain foot switches into RC-505, controlling track record/play and undo/redo. Another page of midi controls 1-8 program changes, to change memories.</p>
<p>MPC live receives midi clock and start/stop from RC-505. MPC live sends audio through RC-505. MPC Live receives program change messages from RC-505, set to change the MPC Live sequence.</p>
<p>Observations:</p>
<p>I have never tried to midi control the mpc live in terms of program changes. There are three options: program, sequence, track. I have it set to change the sequence.</p>
<p>Issues:</p>
<p>Need to send the MPC to the mixer, not through the RC-505.</p>
<p>Is there a footswitch to trigger memory write?</p>
<p>To Do:</p>
<p>Plan is to make an MPC live program to pair with the rc-505. Sequence numbers on the MPC will correspond to memory numbers on the rc-505 (by program change value). Note, that on start-up the rc-505 does not send a program change message, need to toggle into it.</p>
<p>This combo adds a whole bunch of track possibilities. Main audio looping will be taken care of by the rc-505. At the same time, it is possible to record audio into the MPC. I’ll probably avoid this for now. Constraints are good. Very easy to make unlimited midi tracks.</p>
<p>Assign say 4 drum kits to tracks 1-4 on the MPC. Could add more. This gives a few options for beats and kits at a sequence level.</p>
<p>One big MPC program should be able to provide backing beats/tracks to the rc-505.</p>


</section>
</section>

 ]]></description>
  <category>looping</category>
  <category>gear</category>
  <guid>https://homophony.quest/blog/60_4_13_24_weekly/</guid>
  <pubDate>Sat, 13 Apr 2024 04:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/60_4_13_24_weekly/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Ep-133 K.O. II random notes</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/59_3_24_24_ep_133/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"practicing synthesizer on a beach. the sunset is a synthesizer. The moon in the sky is a synthesizer. The trees are made of synthesizers. The ocean is music. colorful. 3d."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/59_3_24_24_ep_133/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>EP-133</p>
</div></div><p>This little sampler is loads of fun. The buttons are snappy. The preloaded samples are fantastic. I loved them so much I put them in a <a href="https://homophony.quest/blog/49_2_15_24_r_soundfonts/index.html#te-ep-133-k.o.-ii">soundfont a while back</a>.</p>
<p>This page is just random notes to self about the EP-133. I haven’t spent too much time with it, and hopefully making notes will help with learning it better, and using it more often.</p>
<section id="manual" class="level2">
<h2 class="anchored" data-anchor-id="manual">Manual</h2>
<p>Official TE online guide:</p>
<p><a href="https://teenage.engineering/guides/ep-133" class="uri">https://teenage.engineering/guides/ep-133</a></p>
</section>
<section id="firmware" class="level2">
<h2 class="anchored" data-anchor-id="firmware">Firmware</h2>
<p>Firmware updates:</p>
<p><a href="https://teenage.engineering/downloads/ep-133" class="uri">https://teenage.engineering/downloads/ep-133</a></p>
<p>Oops, I’m behind. Need to update the firmware. I get to use the handy web-utility: <a href="https://teenage.engineering/apps/update" class="uri">https://teenage.engineering/apps/update</a></p>
<ul>
<li>updated to most recent firmware</li>
</ul>
</section>
<section id="online-sample-tool" class="level2">
<h2 class="anchored" data-anchor-id="online-sample-tool">Online Sample tool</h2>
<p><a href="https://teenage.engineering/apps/ep-sample-tool" class="uri">https://teenage.engineering/apps/ep-sample-tool</a></p>
<ul>
<li>did a factory restore, glad they added that option.</li>
</ul>
</section>
<section id="using-it" class="level2">
<h2 class="anchored" data-anchor-id="using-it">Using it</h2>
<p>The fun factor for finger drumming is really high on this one.</p>
<ol type="1">
<li>Finger drumming straight into a DAW or whatever is close.</li>
</ol>
</section>
<section id="stand-alone" class="level2">
<h2 class="anchored" data-anchor-id="stand-alone">Stand-alone</h2>
<p>Record with the sequencer, play back and record into DAW later.</p>
<p>Projects 1 - 9</p>
<ul>
<li>Each project has four groups (A-D)</li>
<li>12 samples per group</li>
<li>99 patterns per group (up to 99 bars)</li>
<li>99 scenes per pattern (arrangement of scenes)</li>
</ul>
<p>Default factory settings - Projects 1-5 are populated - Projects 6-9 are empty</p>
<p><strong>Change Project</strong>? HOLD MAIN and HOLD one of the pads (1-9), about 1 second together</p>
<ul>
<li>Hold main, blinking light shows current project</li>
</ul>
<p><strong>Pattern Length</strong></p>
<ul>
<li>Default is 1 bar</li>
<li>Increase length HOLD RECORD then +</li>
</ul>
<p><strong>Recording</strong></p>
<ul>
<li>Press record then play, metronome plays</li>
<li>finger drum</li>
<li>erase</li>
<li>undo Shift + B</li>
</ul>
<p><strong>Commit</strong></p>
<hr>
</section>
<section id="things-that-are-annoying" class="level2">
<h2 class="anchored" data-anchor-id="things-that-are-annoying">Things that are annoying</h2>
<p>The main thing I find annoying is an unreasonable thing. So, I’m not actually annoyed, but I am annoyed.</p>
<p>I want to start finger drumming and settle into a groove without any nuisance factors, and then have that groove automatically loop with no effort, and be able to export the loop with no effort.</p>
<p>One approach is to set a bar length, set tempo, turn the metronome on, press record, then jam it out and hope it works (and repeat over and over and over, until I get a take that works). The problem is that I hate metronomes. I don’t “feel” in the groove doing this. I can make stuff that is OK, with lot’s of editing and effort, and on the whole it is NOT FUN.</p>
<p>I’ve tried various ways of playing live and recording into Ableton, but this is also NOT FUN, for lots of reasons.</p>
<p>I’m looking for “The timeless way of having fun finger drumming”.</p>
</section>
<section id="things-im-actually-doing" class="level2">
<h2 class="anchored" data-anchor-id="things-im-actually-doing">Things I’m actually doing</h2>
<section id="record-to-tape-grab-loops-later" class="level3">
<h3 class="anchored" data-anchor-id="record-to-tape-grab-loops-later">Record to “tape”, grab loops later</h3>
<p>This seems to work pretty well. I like to use the EP-133 as a portable device. It’s too bad that it doesn’t record itself. Instead, I need to record into another portable device. I have a Zoom H6 that works well for this kind of thing.</p>
<p>I run the Ep-133 output to the H6 recorder, press record, then drum it out for 10 minutes or whatever. I like this because it is so fun, and I enjoy the actual playing part. I don’t care about mistakes or timing or anything. Alternatively, if I’m nearby a laptop, I’ll record into the laptop, using Adobe Audition. Or, if I’m in the home studio, I’ll record to an SD card through my mixer.</p>
<p>Bottom line is that there is lot’s of flow, and I enjoy this.</p>
<p>Afterward, I bring the wav file into Adobe Audition, listen through it, and cut out any drum loops that I think work. Then, I load these into Ableton, and the warping feature seems to work pretty well at this point.</p>
</section>
<section id="set-really-long-bar-lengths-on-the-ep-133-and-play-live-for-a-long-time" class="level3">
<h3 class="anchored" data-anchor-id="set-really-long-bar-lengths-on-the-ep-133-and-play-live-for-a-long-time">Set really long bar lengths on the EP-133, and play live for a long time</h3>
<p>This works pretty well too.</p>
<p>Hold record, then +, increases the number of bars. Hold + down and it zooms up to 99 bars. I use free play (no quantize), and drum away. Even if it is a big mess, it’s lots of fun, and I can grab any good parts later. Bonus points for being able to use the FX during playback.</p>


</section>
</section>

 ]]></description>
  <category>EP-133</category>
  <category>gear</category>
  <guid>https://homophony.quest/blog/59_3_24_24_ep_133/</guid>
  <pubDate>Sun, 24 Mar 2024 04:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/59_3_24_24_ep_133/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Ep-133 K.O. II random notes</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/61_4_13_24_rc505mkii/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"practicing synthesizer on a beach. the sunset is a synthesizer. The moon in the sky is a synthesizer. The trees are made of synthesizers. The ocean is music. colorful. 3d."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/61_4_13_24_rc505mkii/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>EP-133</p>
</div></div><p>This little sampler is loads of fun. The buttons are snappy. The preloaded samples are fantastic. I loved them so much I put them in a <a href="https://homophony.quest/blog/49_2_15_24_r_soundfonts/index.html#te-ep-133-k.o.-ii">soundfont a while back</a>.</p>
<p>This page is just random notes to self about the EP-133. I haven’t spent too much time with it, and hopefully making notes will help with learning it better, and using it more often.</p>
<section id="manual" class="level2">
<h2 class="anchored" data-anchor-id="manual">Manual</h2>
<p>Official TE online guide:</p>
<p><a href="https://teenage.engineering/guides/ep-133" class="uri">https://teenage.engineering/guides/ep-133</a></p>
</section>
<section id="firmware" class="level2">
<h2 class="anchored" data-anchor-id="firmware">Firmware</h2>
<p>Firmware updates:</p>
<p><a href="https://teenage.engineering/downloads/ep-133" class="uri">https://teenage.engineering/downloads/ep-133</a></p>
<p>Oops, I’m behind. Need to update the firmware. I get to use the handy web-utility: <a href="https://teenage.engineering/apps/update" class="uri">https://teenage.engineering/apps/update</a></p>
<ul>
<li>updated to most recent firmware</li>
</ul>
</section>
<section id="online-sample-tool" class="level2">
<h2 class="anchored" data-anchor-id="online-sample-tool">Online Sample tool</h2>
<p><a href="https://teenage.engineering/apps/ep-sample-tool" class="uri">https://teenage.engineering/apps/ep-sample-tool</a></p>
<ul>
<li>did a factory restore, glad they added that option.</li>
</ul>
</section>
<section id="using-it" class="level2">
<h2 class="anchored" data-anchor-id="using-it">Using it</h2>
<p>The fun factor for finger drumming is really high on this one.</p>
<ol type="1">
<li>Finger drumming straight into a DAW or whatever is close.</li>
</ol>
</section>
<section id="stand-alone" class="level2">
<h2 class="anchored" data-anchor-id="stand-alone">Stand-alone</h2>
<p>Record with the sequencer, play back and record into DAW later.</p>
<p>Projects 1 - 9</p>
<ul>
<li>Each project has four groups (A-D)</li>
<li>12 samples per group</li>
<li>99 patterns per group (up to 99 bars)</li>
<li>99 scenes per pattern (arrangement of scenes)</li>
</ul>
<p>Default factory settings - Projects 1-5 are populated - Projects 6-9 are empty</p>
<p><strong>Change Project</strong>? HOLD MAIN and HOLD one of the pads (1-9), about 1 second together</p>
<ul>
<li>Hold main, blinking light shows current project</li>
</ul>
<p><strong>Pattern Length</strong></p>
<ul>
<li>Default is 1 bar</li>
<li>Increase length HOLD RECORD then +</li>
</ul>
<p><strong>Recording</strong></p>
<ul>
<li>Press record then play, metronome plays</li>
<li>finger drum</li>
<li>erase</li>
<li>undo Shift + B</li>
</ul>
<p><strong>Commit</strong></p>
<hr>
</section>
<section id="things-that-are-annoying" class="level2">
<h2 class="anchored" data-anchor-id="things-that-are-annoying">Things that are annoying</h2>
<p>The main thing I find annoying is an unreasonable thing. So, I’m not actually annoyed, but I am annoyed.</p>
<p>I want to start finger drumming and settle into a groove without any nuisance factors, and then have that groove automatically loop with no effort, and be able to export the loop with no effort.</p>
<p>One approach is to set a bar length, set tempo, turn the metronome on, press record, then jam it out and hope it works (and repeat over and over and over, until I get a take that works). The problem is that I hate metronomes. I don’t “feel” in the groove doing this. I can make stuff that is OK, with lot’s of editing and effort, and on the whole it is NOT FUN.</p>
<p>I’ve tried various ways of playing live and recording into Ableton, but this is also NOT FUN, for lots of reasons.</p>
<p>I’m looking for “The timeless way of having fun finger drumming”.</p>
</section>
<section id="things-im-actually-doing" class="level2">
<h2 class="anchored" data-anchor-id="things-im-actually-doing">Things I’m actually doing</h2>
<section id="record-to-tape-grab-loops-later" class="level3">
<h3 class="anchored" data-anchor-id="record-to-tape-grab-loops-later">Record to “tape”, grab loops later</h3>
<p>This seems to work pretty well. I like to use the EP-133 as a portable device. It’s too bad that it doesn’t record itself. Instead, I need to record into another portable device. I have a Zoom H6 that works well for this kind of thing.</p>
<p>I run the Ep-133 output to the H6 recorder, press record, then drum it out for 10 minutes or whatever. I like this because it is so fun, and I enjoy the actual playing part. I don’t care about mistakes or timing or anything. Alternatively, if I’m nearby a laptop, I’ll record into the laptop, using Adobe Audition. Or, if I’m in the home studio, I’ll record to an SD card through my mixer.</p>
<p>Bottom line is that there is lot’s of flow, and I enjoy this.</p>
<p>Afterward, I bring the wav file into Adobe Audition, listen through it, and cut out any drum loops that I think work. Then, I load these into Ableton, and the warping feature seems to work pretty well at this point.</p>
</section>
<section id="set-really-long-bar-lengths-on-the-ep-133-and-play-live-for-a-long-time" class="level3">
<h3 class="anchored" data-anchor-id="set-really-long-bar-lengths-on-the-ep-133-and-play-live-for-a-long-time">Set really long bar lengths on the EP-133, and play live for a long time</h3>
<p>This works pretty well too.</p>
<p>Hold record, then +, increases the number of bars. Hold + down and it zooms up to 99 bars. I use free play (no quantize), and drum away. Even if it is a big mess, it’s lots of fun, and I can grab any good parts later. Bonus points for being able to use the FX during playback.</p>


</section>
</section>

 ]]></description>
  <category>EP-133</category>
  <category>gear</category>
  <guid>https://homophony.quest/blog/61_4_13_24_rc505mkii/</guid>
  <pubDate>Sun, 24 Mar 2024 04:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/61_4_13_24_rc505mkii/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Weekly practice March 17-22</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/58_3_19_24_weekly_piano/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"practicing synthesizer on a beach. the sunset is a synthesizer. The moon in the sky is a synthesizer. The trees are made of synthesizers. The ocean is music. colorful. 3d."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/58_3_19_24_weekly_piano/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>practicing synthesizer on a beach. the sunset is a synthesizer. The moon in the sky is a synthesizer. The trees are made of synthesizers. The ocean is music. colorful. 3d.</p>
</div></div><p>It’s been a while since I posted. The semester has been spinning its wheels. My goal is to get back into the habit of daily musical somethings.</p>
<p>3/17 - Got to mess around on a Moog One!</p>
<p>3/18 - Noodled around on a couple Jazz Standards</p>
<ul>
<li>All of me</li>
<li>April in Paris…took a Thelonius Monk direction</li>
</ul>
<p>3/19 &amp; 3/20 - More standards</p>
<ul>
<li>The blue room</li>
<li>Great for memorable intervals</li>
</ul>
<p>3/23 - Recorded a version of the Blue Room with Osmose presets. Sounds like muppets</p>
<p>3/24 - refamiliarize myself with Ep 1-33</p>



 ]]></description>
  <category>music practice</category>
  <guid>https://homophony.quest/blog/58_3_19_24_weekly_piano/</guid>
  <pubDate>Tue, 19 Mar 2024 04:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/58_3_19_24_weekly_piano/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Adobe after effects scratchpad</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/57_2_24_24_after_effects/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Space station universe situation. Synthesizer universe. Neon. 80s Cartoon. Thundercats. Command station."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/57_2_24_24_after_effects/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Adobe after effects logo</p>
</div></div><p>Making random notes about adobe after effects.</p>
<p>Perhaps a small collection of formula expressions may emerge here over time.</p>
<section id="sine-wave-formula" class="level2">
<h2 class="anchored" data-anchor-id="sine-wave-formula">Sine wave formula</h2>
<p>a = amplitude (multiplier of -1 to 1) f = frequency (1/30 would do one cycle in a 30 sec comp) y = value of sine wave over time</p>
<p>value of some effect to assign</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1">a = 617;</span>
<span id="cb2-2">f = 1/30;</span>
<span id="cb2-3">y = Math.sin(time*2*Math.PI*f)*a;</span>
<span id="cb2-4"></span>
<span id="cb2-5">effect("Transform")("Skew Axis").value = y;</span></code></pre></div>


</section>

 ]]></description>
  <category>after effects</category>
  <category>vfx</category>
  <guid>https://homophony.quest/blog/57_2_24_24_after_effects/</guid>
  <pubDate>Sat, 24 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/57_2_24_24_after_effects/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>VO: Every Station Needs Command: Canvas Animation</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/56_2_23_24_every_station/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Space station universe situation. Synthesizer universe. Neon. 80s Cartoon. Thundercats. Command station."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/56_2_23_24_every_station/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Record player. White background. Robot Transformer record player. 3d. Linocut. Neon. Lasers. Awesomeness - dreamshaper-xl-turbo</p>
</div></div><p>Yet another quick post on making an animation for an older track.</p>
<section id="vo-every-station-needs-command" class="level2">
<h2 class="anchored" data-anchor-id="vo-every-station-needs-command">VO: Every Station Needs Command</h2>
<p>This one is <a href="https://homophony.quest/music/VO.html">Every Station Needs Command from VO</a>. It’s a bit alternative indie rock synth downtempo thing?</p>
</section>
<section id="animation-details" class="level2">
<h2 class="anchored" data-anchor-id="animation-details">Animation details</h2>
<p>I put in this prompt, “Space station universe situation. Synthesizer universe. Neon. 80s Cartoon. Thundercats. Command station.” to dreamshaper-turbo-xl.</p>
<p>This time I have a plan for what I want to do in adobe after effects. Most likely I will pick one of these pictures. Then, I’ll load it into AE. The vision is a series of circles, rotating in alternating directions, potentially bouncing a little bit to the beat. I’ll fill the circles with the picture. It will start with the picture as normal, then the picture, which will be composed of a series of lined up concentric circles, will rotate away from itself as the circles spin around, and then back to it’s starting position. Or something like that.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="4">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="my-gallery" title="synth_21_11.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_21_11.jpeg" class="img-fluid figure-img" alt="synth_21_11.jpeg"></a></p>
<figcaption>synth_21_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="my-gallery" title="synth_21_6.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_21_6.jpeg" class="img-fluid figure-img" alt="synth_21_6.jpeg"></a></p>
<figcaption>synth_21_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="my-gallery" title="synth_22_11.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_22_11.jpeg" class="img-fluid figure-img" alt="synth_22_11.jpeg"></a></p>
<figcaption>synth_22_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="my-gallery" title="synth_22_6.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_22_6.jpeg" class="img-fluid figure-img" alt="synth_22_6.jpeg"></a></p>
<figcaption>synth_22_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="my-gallery" title="synth_23_11.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_23_11.jpeg" class="img-fluid figure-img" alt="synth_23_11.jpeg"></a></p>
<figcaption>synth_23_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="my-gallery" title="synth_23_6.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_23_6.jpeg" class="img-fluid figure-img" alt="synth_23_6.jpeg"></a></p>
<figcaption>synth_23_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="my-gallery" title="synth_24_11.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_24_11.jpeg" class="img-fluid figure-img" alt="synth_24_11.jpeg"></a></p>
<figcaption>synth_24_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="my-gallery" title="synth_24_6.jpeg"><img src="https://homophony.quest/blog/56_2_23_24_every_station/images/synth_24_6.jpeg" class="img-fluid figure-img" alt="synth_24_6.jpeg"></a></p>
<figcaption>synth_24_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="youtube-short" class="level2">
<h2 class="anchored" data-anchor-id="youtube-short">Youtube Short</h2>
<p>A couple spinning circles inside a command station.</p>
<iframe width="315" height="560" src="https://www.youtube.com/embed/XF3RGcqwaF8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>



</section>

 ]]></description>
  <category>VO</category>
  <category>video</category>
  <category>canvas animation</category>
  <category>youtube short</category>
  <guid>https://homophony.quest/blog/56_2_23_24_every_station/</guid>
  <pubDate>Fri, 23 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/56_2_23_24_every_station/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>VO: Slow Down: Canvas Animation</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/55_2_22_24_slow_down/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Record player. White background. Robot Transformer record player. 3d. Linocut. Neon. Lasers. Awesomeness"</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Record player. White background. Robot Transformer record player. 3d. Linocut. Neon. Lasers. Awesomeness - dreamshaper-xl-turbo</p>
</div></div><p>Following in the same footsteps as other posts where I mangle some visuals for a track off an older album</p>
<section id="vo-slow-down" class="level2">
<h2 class="anchored" data-anchor-id="vo-slow-down">VO: Slow down</h2>
<p>This one is <a href="https://homophony.quest/music/VO.html">slow down from VO</a>. It’s short and kind of breakbeat-ish.</p>
</section>
<section id="animation-details" class="level2">
<h2 class="anchored" data-anchor-id="animation-details">Animation details</h2>
<p>Feeding this prompt to dreamshaper-xl-turbo:</p>
<p>“Record player. White background. Robot Transformer record player. 3d. Linocut. Neon. Lasers. Awesomeness”</p>
<p>Then, do something with one or another of these.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="4">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="my-gallery" title="synth_21_11.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_21_11.jpeg" class="img-fluid figure-img" alt="synth_21_11.jpeg"></a></p>
<figcaption>synth_21_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="my-gallery" title="synth_21_6.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_21_6.jpeg" class="img-fluid figure-img" alt="synth_21_6.jpeg"></a></p>
<figcaption>synth_21_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="my-gallery" title="synth_22_11.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_22_11.jpeg" class="img-fluid figure-img" alt="synth_22_11.jpeg"></a></p>
<figcaption>synth_22_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="my-gallery" title="synth_22_6.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_22_6.jpeg" class="img-fluid figure-img" alt="synth_22_6.jpeg"></a></p>
<figcaption>synth_22_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="my-gallery" title="synth_23_11.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_23_11.jpeg" class="img-fluid figure-img" alt="synth_23_11.jpeg"></a></p>
<figcaption>synth_23_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="my-gallery" title="synth_23_6.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_23_6.jpeg" class="img-fluid figure-img" alt="synth_23_6.jpeg"></a></p>
<figcaption>synth_23_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="my-gallery" title="synth_24_11.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_24_11.jpeg" class="img-fluid figure-img" alt="synth_24_11.jpeg"></a></p>
<figcaption>synth_24_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="my-gallery" title="synth_24_6.jpeg"><img src="https://homophony.quest/blog/55_2_22_24_slow_down/images/synth_24_6.jpeg" class="img-fluid figure-img" alt="synth_24_6.jpeg"></a></p>
<figcaption>synth_24_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="youtube-short" class="level2">
<h2 class="anchored" data-anchor-id="youtube-short">Youtube Short</h2>
<p>Some digitally noised up transformer djs.</p>
<iframe width="315" height="560" src="https://www.youtube.com/embed/DYjPAHZ5sBc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>



</section>

 ]]></description>
  <category>VO</category>
  <category>video</category>
  <category>canvas animation</category>
  <category>youtube short</category>
  <guid>https://homophony.quest/blog/55_2_22_24_slow_down/</guid>
  <pubDate>Thu, 22 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/55_2_22_24_slow_down/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>VO: Country Fire: Canvas Animation</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/54_2_22_24_country_fire/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R2D2 robots setting a country on fire. R2D2 everwhere. City scape. cartoon. neon bright sunset. 80s. linocut."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1920</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>R2D2 robots setting a country on fire. R2D2 everwhere. City scape. cartoon. neon bright sunset. 80s. linocut. - dreamshaper-xl-turbo</p>
</div></div><p>I’ve been having some fun making short animations with Adobe After effects for the tracks on <a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a>. I started with 7 second animations for the Spotify canvas format. These play in the background when a track is played on Spotify (on mobile I think?). Then more fun was had by lengthening them to 30 seconds for youtube shorts. See this playlist:</p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/videoseries?si=hujwZ5LEb0flabKB&amp;list=PLDI1NnDZMA8OmYG14hXchvwxpPBypxtxf" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>
<p>I figure I’ll keep making these for some of the tracks on the older albums.</p>
<section id="vo-country-fire" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="vo-country-fire">VO: Country Fire</h2>
<p>This morning I’m choosing <a href="https://homophony.quest/music/VO.html">Country Fire from VO</a>. It’s a synthified country/blues song with heavy vocoder. There are periods of rambunctious bleep boops, which sound like a bunch of R2D2s on the prowl.</p>
<p>As a quick aside, I jumped into “Apple music for artists”, and took a quick look at their “promote” features, which produce little graphics like the one in the margin.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="https://homophony.quest/music/VO.html"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/Country-Fire_coverImageSquareStatic_2024-02-22T08_28.png" class="img-fluid"></a></p>
</div></div></section>
<section id="animation-details" class="level2">
<h2 class="anchored" data-anchor-id="animation-details">Animation details</h2>
<p>Feeding this prompt to dreamshaper-xl-turbo:</p>
<p>“R2D2 robots setting a country on fire. R2D2 everwhere. City scape. cartoon. neon bright sunset. 80s. linocut.”</p>
<p>Then, the plan is to mangle these in Adobe after effects…let’s see what happens.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="4">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="my-gallery" title="synth_21_11.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_21_11.jpeg" class="img-fluid figure-img" alt="synth_21_11.jpeg"></a></p>
<figcaption>synth_21_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="my-gallery" title="synth_21_6.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_21_6.jpeg" class="img-fluid figure-img" alt="synth_21_6.jpeg"></a></p>
<figcaption>synth_21_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="my-gallery" title="synth_22_11.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_22_11.jpeg" class="img-fluid figure-img" alt="synth_22_11.jpeg"></a></p>
<figcaption>synth_22_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="my-gallery" title="synth_22_6.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_22_6.jpeg" class="img-fluid figure-img" alt="synth_22_6.jpeg"></a></p>
<figcaption>synth_22_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="my-gallery" title="synth_23_11.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_23_11.jpeg" class="img-fluid figure-img" alt="synth_23_11.jpeg"></a></p>
<figcaption>synth_23_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="my-gallery" title="synth_23_6.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_23_6.jpeg" class="img-fluid figure-img" alt="synth_23_6.jpeg"></a></p>
<figcaption>synth_23_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="my-gallery" title="synth_24_11.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_24_11.jpeg" class="img-fluid figure-img" alt="synth_24_11.jpeg"></a></p>
<figcaption>synth_24_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="my-gallery" title="synth_24_6.jpeg"><img src="https://homophony.quest/blog/54_2_22_24_country_fire/images/synth_24_6.jpeg" class="img-fluid figure-img" alt="synth_24_6.jpeg"></a></p>
<figcaption>synth_24_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="youtube-short" class="level2">
<h2 class="anchored" data-anchor-id="youtube-short">Youtube Short</h2>
<p>Very noisy and pixely! I blended through the above images and used the audio to bounce some of the vfx. R2D2s wreching havoc everywhere.</p>
<iframe width="315" height="560" src="https://www.youtube.com/embed/4BJtonQywoU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>



</section>

 ]]></description>
  <category>VO</category>
  <category>video</category>
  <guid>https://homophony.quest/blog/54_2_22_24_country_fire/</guid>
  <pubDate>Thu, 22 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/54_2_22_24_country_fire/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Process thoughts on a new album: Basement Tapes 1</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/52_2_19_24_bt_album/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"synthesizer city. sunset. synthesizers everywhere. mountains. retro. 80s cartoon. linocut. synthwave. neon."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">576</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1336</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Basement Tapes 1: Album cover</p>
</div></div><p>I wasn’t expecting to <a href="https://homophony.quest/music/Basement_Tapes.html">release an album this weekend</a>. It just turned out that way.</p>
<p>This post is an “album-liner-notes” to self about some of the process steps. In general, I hope that writing about these things will both the make the process easier next time, and potentially suggest new things to try or old things to avoid.</p>
<p>As a solo-artist (i.e., part-time basement synth hermit dabbler) I’ve “released” three whole albums: <a href="https://homophony.quest/music/VO.html">VO</a>, <a href="https://homophony.quest/music/RS.html">RS</a>, and now <a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a>. I say “released” because besides making the music, all I did was pay <a href="https://distrokid.com/">distrokid</a> to distribute the tracks to most major streaming platforms.</p>
<p>I’ve been playing and recording music since I was a kid, gigged with a few bands here and there– all for fun and the joy of playing. Up until a few years ago, the prospect of releasing a whole album in some kind of standard media format seemed very challenging, and I didn’t have any time for it. I had a lot of extra time during the pandemic, was playing and recording a bunch of music, and at some point I started wondering how artists got their music up on streaming platforms. I was surprised to learn about services like distrokid that will get your music onto major streaming platforms…for pretty cheap too. So, in 2020 I put <a href="https://homophony.quest/music/VO.html">VO</a> together and did the distrokid thing to get it out there.</p>
<p>Some topics to cover for this post: general music production approach, Basement Tapes 1 notes, sharing music online, using distrokid, all the extra stuff</p>
<section id="general-music-production-approach" class="level2">
<h2 class="anchored" data-anchor-id="general-music-production-approach">General music production approach</h2>
<p>I’ll make this section short, as my general approach is to try things and listen to what happens.</p>
<p>I have a synth room full of fun gear. I really like to play live more than fidget with things. Everything feeds into a multi-track mixer that records to an SD card, or to a tape deck, or to a computer. Sometimes I have a musical idea and sometimes I don’t and it develops over a session. I’ll typically lay down all of the parts of some song, play lots of variations of everything (e.g., using take lanes in Ableton), and then sit down and edit things. When I get bored of editing, I’ll aim for a process where everything is recorded live, and whatever happens is what I get.</p>
<p>If I’m a hobby musician, I’m an absolute hack sound engineer. It’s 100% that my final mixes are completely boneheaded in a gajillion ways from Sunday. Still, it’s been a lot of fun learning about mixing and mastering. So much there to learn.</p>
<p>My basic mixing/mastering process is:</p>
<ol type="1">
<li>Get rid of line noise, make sure input gain is decent for recording</li>
<li>Set levels while playing to things that sound good to me</li>
<li>If I’m in Ableton, totally mess around with every track adding bits of effects here and there, lots of parameter automation. Keep it subtle for the most part.</li>
<li>Slap a “mixing and mastering” ableton effect rack onto the master channel, followed by a limiter to get the loudness under control.</li>
<li>Leave it, come back, listen to it again in horror of what was I thinking the first time I did this.</li>
<li>Maybe remove noise in Adobe Audition, especially if the tape deck was involved.</li>
</ol>
</section>
<section id="basement-tapes-1-notes" class="level2">
<h2 class="anchored" data-anchor-id="basement-tapes-1-notes">Basement Tapes 1 notes</h2>
<p>The first two albums, <a href="https://homophony.quest/music/VO.html">VO</a> and <a href="https://homophony.quest/music/RS.html">RS</a>, are more in the experimental “synth pop” direction. I had bought a vocoder and couldn’t resist singing into it…resulting in VO. RS has much less “singing”, which is better for everybody. But, both of those albums involved heavy use of Ableton to get the final tracks into shape.</p>
<p><a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a> are a collection of mostly impromptu live recordings from about 2020 onward…the recording dates for each track are a bit hazy.</p>
<p>My neighbor had bought a PYLE cassette tape deck to transfer a whole bunch of tapes to digital. However, he couldn’t get the USB drivers to work for his computer and gifted me the tape deck instead. It had been ages since I had a tape deck, and I love the squishy compression of recording to tape. So, I spent a bunch of time recording whole live tracks onto tape, as a kind of musical journal.</p>
<p>I was making heavy use of the Rhodes, OB-6, Matriarch, and modular stuff. Most of the tracks have a slower downtempo feel. Occasionally they devolve into the sounds of modems connecting to the internet. My overall take on these tracks are they are things I made and decided to share for fun, and to help me document my process a little bit.</p>
</section>
<section id="sharing-music-online" class="level2">
<h2 class="anchored" data-anchor-id="sharing-music-online">Sharing music online</h2>
<p>I’ve maintained websites for sharing some of the <a href="https://www.crumplab.com/things/">visual things I make</a> for years, but it’s only relatively recently that I’ve tried to share music.</p>
<p>I joined soundcloud way back and occasionally posted tracks <a href="https://soundcloud.com/matt-crump-913298049">here</a>. I think the Basement Tape tracks are still there. But, ugh, soundcloud, it’s seems to have gotten worse and worse, and I am not feeling it.</p>
<p><a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a> mostly emerged out of my desire to try different methods of sharing music, and to use the sharing process as a side adventure in curating my own work. For example, in 2022 I discovered mastodon and got interested in sharing music using fediverse tools like funkwhale (<a href="https://www.crumplab.com/blog/778_funkwhale/">blogged about my set up attempts here</a>). Ultimately, I didn’t stick with funkwhale, but the experience helped me get closer to a sharing process that made sense for me.</p>
<p>In terms of sharing music, I was interested in being able to bundle assets together and share them all in one place. For example, I’d want to have the track somewhere, along with possible cover art, production notes, gear notes, musical concept notes, or any other tidbits I might want to attach. Funkwhale offered some of these things. At the same time, so did Mastodon in general. For a while, I was posting about each of the tracks on <a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a> on my old mastodon instance. Each of the posts had the track and usually some “tasting notes” about what the track sounded like.</p>
<p>After I shut down those things, I moved all of the tracks to a notion database, and that worked pretty well for general track organization. And, in principle I could have shared the music from notion.</p>
<p>At some point I had purchased the domain for this site, <a href="https://homophony.quest">https://homophony.quest</a>, and eventually decided to build a <a href="https://quarto.org">quarto</a> website here to “officially” share music. It keeps me busy, and gives me some motivation to keep playing more music.</p>
<p>This weekend I gave the album pages for <a href="https://homophony.quest/music/VO.html">VO</a>, <a href="https://homophony.quest/music/RS.html">RS</a>, and <a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a> a facelift and added embedded players for apple music and spotify. For <a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a>, I also added a bunch of production notes I had been keeping in the notion database.</p>
<p>I could share the music for these albums directly on <a href="https://homophony.quest">https://homophony.quest</a>, but I haven’t done that yet. VO and RS were already distributed by distrokid, and Basement Tapes 1 was up on soundcloud. Plus, I hadn’t yet figured out how to share a playable audio file on a quarto page, but I have since. Still, if I put too many tracks on a single page they are very slow to load, so I haven’t figured everything out. Also, although I have some ambivalence about using major streaming platforms, at least it makes it easy for me to listen to my own music on my own devices in a flexible way. For example, if my tracks are on apple music, it’s easy for me to stream them to myself, or put them in a playlist etc.</p>
<p>A couple months ago I added this blog onto <a href="https://homophony.quest">https://homophony.quest</a> and have shared a <a href="https://homophony.quest/music/New.html">few new tracks</a>, and bits and pieces of things across <a href="https://homophony.quest/notes.html">blog posts</a>. I’ve really enjoyed this set up. It’s easy to publish whenever I want. It’s easy to add a track, or write about some musical process, or both. I’m sticking with this rough pattern more or less for now.</p>
<p>At the same time, I found this <a href="https://www.nytimes.com/2024/01/13/business/music-streaming-fraud-spotify.html">NYT article</a> on phantom artists stealing music very upsetting. I’m not looking to make cash from music, but the idea of someone else stealing it (say, off of soundcloud, or wherever your music is posted to the internet) to make cash for themselves gives me major frowny face.</p>
<p>Whereas, it would be fun to develop a track and post about it and share it on this blog, be it resolved that it would suck to have someone steal it and distribute it without your knowledge.</p>
<p>I suspect that I’m not a major target for this type of music theft, but nevertheless, it left a sad trombone sound in my ear. And, this whole nonsense was the major reason why I released <a href="https://homophony.quest/music/Basement_Tapes.html">Basement Tapes 1</a> over the weekend. I had a spare hour (and that’s almost all it takes to upload tracks to distrokid), and decided to put the tracks out there. They had been up on soundcloud for over a year. I was curious if someone had pirated them and tried to distribute them already without my knowledge. I assumed I might learn about that by attempting to distribute them with distrokid. For example, perhaps these music stores do some quick plagiarism checks or something, and would deny my tracks if they were already somehow on the service. Fortunately that didn’t happen.</p>
<p>I’m not sure what my plans are for sharing finished tracks in the future. Some mix of bits and pieces on the blog, and then distributing full tracks through distrokid or a similar service.</p>
</section>
<section id="using-distrokid" class="level2">
<h2 class="anchored" data-anchor-id="using-distrokid">Using Distrokid</h2>
<p>I don’t have too much to say about this right now. I’ve found the service to be fairly smooth. I’m not paying for all the bells and whistles, which quickly add cost to releasing an album. It’s nice that they distribute widely to various platforms, which makes it easy for me to access the tracks depending on the situation.</p>
<p>I did click through the option to manage my artist profile on spotify, apple music, and youtube, which adds even more stuff to do, should one care to do extra stuff</p>
</section>
<section id="extra-stuff" class="level2">
<h2 class="anchored" data-anchor-id="extra-stuff">Extra stuff</h2>
<p>It’s almost time to start work.</p>
<p>This time the extra stuff was to make short mp4 videos for the Spotify canvas feature. I had previously created cover art for each track using a combination of midjourney, and the “tasting notes” that I wrote for each track as a prompt to midjourney. I put these images into Adobe After effects and made short 7 sec clips for each of them. I stopped using Spotify in general, so I’m not sure why I went overboard on this extra stuff, but it was fun to make the video clips.</p>
</section>
<section id="midjourney-cover-pictures" class="level2">
<h2 class="anchored" data-anchor-id="midjourney-cover-pictures">Midjourney cover pictures</h2>
<p>I still don’t know what to think about using generative models to make pictures. Nowadays it’s mostly misgivings, with some idle curiosity about what happens if I try x?</p>
<p>I have had some interest in programmatically generating images for a long time, and have done all sorts of weird computer image stuff. The cover art for VO and RS was generated by a very early latent image space model. I like the in-between weird images.</p>
<p>When I was bouncing tracks for this album midjourney had started to become available. I think this was my first and only time trying to do anything on discord. Anyway, I generated these images using prompts for describing what I heard in the music.</p>
<p>I still have the prompts, but I doubt any of this is reproducible, so I have no idea how to attribute any of this.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="4">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_1_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="my-gallery" title="Tape 1"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_1_midjourney.jpg" class="img-fluid figure-img" alt="Tape 1"></a></p>
<figcaption>Tape 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_2_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="my-gallery" title="Tape 2"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_2_midjourney.jpg" class="img-fluid figure-img" alt="Tape 2"></a></p>
<figcaption>Tape 2</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_3_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="my-gallery" title="Tape 3"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_3_midjourney.jpg" class="img-fluid figure-img" alt="Tape 3"></a></p>
<figcaption>Tape 3</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_4_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="my-gallery" title="Tape 4"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_4_midjourney.jpg" class="img-fluid figure-img" alt="Tape 4"></a></p>
<figcaption>Tape 4</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_5_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="my-gallery" title="Tape 5"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_5_midjourney.jpg" class="img-fluid figure-img" alt="Tape 5"></a></p>
<figcaption>Tape 5</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_6_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="my-gallery" title="Tape 6"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_6_midjourney.jpg" class="img-fluid figure-img" alt="Tape 6"></a></p>
<figcaption>Tape 6</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_7_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="my-gallery" title="Tape 7"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_7_midjourney.jpg" class="img-fluid figure-img" alt="Tape 7"></a></p>
<figcaption>Tape 7</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_8_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="my-gallery" title="Tape 8"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_8_midjourney.jpg" class="img-fluid figure-img" alt="Tape 8"></a></p>
<figcaption>Tape 8</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_10_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="my-gallery" title="Tape 10"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_10_midjourney.jpg" class="img-fluid figure-img" alt="Tape 10"></a></p>
<figcaption>Tape 10</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_11_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-11" data-gallery="my-gallery" title="Tape 11"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_11_midjourney.jpg" class="img-fluid figure-img" alt="Tape 11"></a></p>
<figcaption>Tape 11</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Tape_13_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-12" data-gallery="my-gallery" title="Tape 13"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Tape_13_midjourney.jpg" class="img-fluid figure-img" alt="Tape 13"></a></p>
<figcaption>Tape 13</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="album_imgs/Track_14_midjourney.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-13" data-gallery="my-gallery" title="Tape 14"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/album_imgs/Track_14_midjourney.jpg" class="img-fluid figure-img" alt="Tape 14"></a></p>
<figcaption>Tape 14</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="spotify-banner-pictures" class="level2">
<h2 class="anchored" data-anchor-id="spotify-banner-pictures">Spotify banner pictures</h2>
<p>I recently updated my spotify artist banner with this image. Although, I mostly do not use generative models when <a href="https://www.crumplab.com/things/">I make visual things</a>, I have been generating images a fair amount on this music blog.</p>
<p>For example, the spotify banner was made with <a href="https://huggingface.co/Lykon/dreamshaper-xl-turbo">Dreamshaper-xl-turbo</a>, and the source code for this one is in the python code chunk at the top of this post. This image and the others made with this process should be reproducible by using the source code and the same random seeds that I used.</p>
<p>Ideally there would be a way to at least attribute the construction of these images to their sources, as well as pay for it, perhaps like a streaming service.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_27_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-14" data-gallery="my-gallery-2" title="synth_27_11"><img src="https://homophony.quest/blog/52_2_19_24_bt_album/images/synth_27_11.jpeg" class="img-fluid figure-img" alt="synth_27_11"></a></p>
<figcaption>synth_27_11</figcaption>
</figure>
</div>
<p>For example, this image is in some sense composed from a weighted combination from source images in the generative model, or at least it might have an interpretation as a weighted combination. If the source images and their originators were known, then this image could be attributed with a vector assigning weights to the original sources.</p>
<p>Anyway, I like cheesy stuff, and these generated images are super cheese, even smelly cheese. I will probably keep fooling around with them until I eat too much of this cheese, and go find some other cheese.</p>
</section>
<section id="instagram-reels" class="level2">
<h2 class="anchored" data-anchor-id="instagram-reels">Instagram reels</h2>
<p>Not going to get started on my feelz for reels…</p>
<p>I feel like it is a waste to make short 7 second clips just for spotify, so I’m looking to recoup my costs. I have an instagram account where I post visual stuff and am trying out the following:</p>
<ol type="1">
<li>Upload the mp4 for the spotify canvas as a reel to Instagram.</li>
<li>Distrokid has made my album available on instagram, so I choose a short loop from a track as the audio for the reel.</li>
<li>Add some notes to the reel…share it.</li>
</ol>
<p>Then, will it embed here? I guess so.</p>
<div style="width:50%;">
<blockquote class="instagram-media blockquote" data-instgrm-captioned="" data-instgrm-permalink="https://www.instagram.com/reel/C3kzqZqu529/?utm_source=ig_embed&amp;utm_campaign=loading" data-instgrm-version="14" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:540px; min-width:326px; padding:0; width:50%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);">
<div style="padding:16px;">
<a href="https://www.instagram.com/reel/C3kzqZqu529/?utm_source=ig_embed&amp;utm_campaign=loading" style=" background:#FFFFFF; line-height:0; padding:0 0; text-align:center; text-decoration:none; width:100%;" target="_blank">
<div style=" display: flex; flex-direction: row; align-items: center;">
<div style="background-color: #F4F4F4; border-radius: 50%; flex-grow: 0; height: 40px; margin-right: 14px; width: 40px;">

</div>
<div style="display: flex; flex-direction: column; flex-grow: 1; justify-content: center;">
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; margin-bottom: 6px; width: 100px;">

</div>
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; width: 60px;">

</div>
</div>
</div>
<div style="padding: 19% 0;">

</div>
<div style="display:block; height:50px; margin:0 auto 12px; width:50px;">
<svg width="50px" height="50px" viewbox="0 0 60 60" version="1.1" xmlns="https://www.w3.org/2000/svg" xlink="https://www.w3.org/1999/xlink">
<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-511.000000, -20.000000)" fill="#000000"><g><path d="M556.869,30.41 C554.814,30.41 553.148,32.076 553.148,34.131 C553.148,36.186 554.814,37.852 556.869,37.852 C558.924,37.852 560.59,36.186 560.59,34.131 C560.59,32.076 558.924,30.41 556.869,30.41 M541,60.657 C535.114,60.657 530.342,55.887 530.342,50 C530.342,44.114 535.114,39.342 541,39.342 C546.887,39.342 551.658,44.114 551.658,50 C551.658,55.887 546.887,60.657 541,60.657 M541,33.886 C532.1,33.886 524.886,41.1 524.886,50 C524.886,58.899 532.1,66.113 541,66.113 C549.9,66.113 557.115,58.899 557.115,50 C557.115,41.1 549.9,33.886 541,33.886 M565.378,62.101 C565.244,65.022 564.756,66.606 564.346,67.663 C563.803,69.06 563.154,70.057 562.106,71.106 C561.058,72.155 560.06,72.803 558.662,73.347 C557.607,73.757 556.021,74.244 553.102,74.378 C549.944,74.521 548.997,74.552 541,74.552 C533.003,74.552 532.056,74.521 528.898,74.378 C525.979,74.244 524.393,73.757 523.338,73.347 C521.94,72.803 520.942,72.155 519.894,71.106 C518.846,70.057 518.197,69.06 517.654,67.663 C517.244,66.606 516.755,65.022 516.623,62.101 C516.479,58.943 516.448,57.996 516.448,50 C516.448,42.003 516.479,41.056 516.623,37.899 C516.755,34.978 517.244,33.391 517.654,32.338 C518.197,30.938 518.846,29.942 519.894,28.894 C520.942,27.846 521.94,27.196 523.338,26.654 C524.393,26.244 525.979,25.756 528.898,25.623 C532.057,25.479 533.004,25.448 541,25.448 C548.997,25.448 549.943,25.479 553.102,25.623 C556.021,25.756 557.607,26.244 558.662,26.654 C560.06,27.196 561.058,27.846 562.106,28.894 C563.154,29.942 563.803,30.938 564.346,32.338 C564.756,33.391 565.244,34.978 565.378,37.899 C565.522,41.056 565.552,42.003 565.552,50 C565.552,57.996 565.522,58.943 565.378,62.101 M570.82,37.631 C570.674,34.438 570.167,32.258 569.425,30.349 C568.659,28.377 567.633,26.702 565.965,25.035 C564.297,23.368 562.623,22.342 560.652,21.575 C558.743,20.834 556.562,20.326 553.369,20.18 C550.169,20.033 549.148,20 541,20 C532.853,20 531.831,20.033 528.631,20.18 C525.438,20.326 523.257,20.834 521.349,21.575 C519.376,22.342 517.703,23.368 516.035,25.035 C514.368,26.702 513.342,28.377 512.574,30.349 C511.834,32.258 511.326,34.438 511.181,37.631 C511.035,40.831 511,41.851 511,50 C511,58.147 511.035,59.17 511.181,62.369 C511.326,65.562 511.834,67.743 512.574,69.651 C513.342,71.625 514.368,73.296 516.035,74.965 C517.703,76.634 519.376,77.658 521.349,78.425 C523.257,79.167 525.438,79.673 528.631,79.82 C531.831,79.965 532.853,80.001 541,80.001 C549.148,80.001 550.169,79.965 553.369,79.82 C556.562,79.673 558.743,79.167 560.652,78.425 C562.623,77.658 564.297,76.634 565.965,74.965 C567.633,73.296 568.659,71.625 569.425,69.651 C570.167,67.743 570.674,65.562 570.82,62.369 C570.966,59.17 571,58.147 571,50 C571,41.851 570.966,40.831 570.82,37.631"></path></g></g></g>
</svg>
</div>
<div style="padding-top: 8px;">
<div style=" color:#3897f0; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:550; line-height:18px;">
View this post on Instagram
</div>
</div>
<div style="padding: 12.5% 0;">

</div>
<div style="display: flex; flex-direction: row; margin-bottom: 14px; align-items: center;">
<div>
<div style="background-color: #F4F4F4; border-radius: 50%; height: 12.5px; width: 12.5px; transform: translateX(0px) translateY(7px);">

</div>
<div style="background-color: #F4F4F4; height: 12.5px; transform: rotate(-45deg) translateX(3px) translateY(1px); width: 12.5px; flex-grow: 0; margin-right: 14px; margin-left: 2px;">

</div>
<div style="background-color: #F4F4F4; border-radius: 50%; height: 12.5px; width: 12.5px; transform: translateX(9px) translateY(-18px);">

</div>
</div>
<div style="margin-left: 8px;">
<div style=" background-color: #F4F4F4; border-radius: 50%; flex-grow: 0; height: 20px; width: 20px;">

</div>
<div style=" width: 0; height: 0; border-top: 2px solid transparent; border-left: 6px solid #f4f4f4; border-bottom: 2px solid transparent; transform: translateX(16px) translateY(-4px) rotate(30deg)">

</div>
</div>
<div style="margin-left: auto;">
<div style=" width: 0px; border-top: 8px solid #F4F4F4; border-right: 8px solid transparent; transform: translateY(16px);">

</div>
<div style=" background-color: #F4F4F4; flex-grow: 0; height: 12px; width: 16px; transform: translateY(-4px);">

</div>
<div style=" width: 0; height: 0; border-top: 8px solid #F4F4F4; border-left: 8px solid transparent; transform: translateY(-4px) translateX(8px);">

</div>
</div>
</div>
<div style="display: flex; flex-direction: column; flex-grow: 1; justify-content: center; margin-bottom: 24px;">
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; margin-bottom: 6px; width: 224px;">

</div>
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; width: 144px;">

</div>
</div>
</a>
<p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;">
<a href="https://www.instagram.com/reel/C3kzqZqu529/?utm_source=ig_embed&amp;utm_campaign=loading" style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none;" target="_blank">A post shared by Matt Crump (<span class="citation" data-cites="mattcrumplab">@mattcrumplab</span>)</a>
</p>
</div>
</blockquote>
<script async="" src="//www.instagram.com/embed.js"></script>
</div>
<p>Nuisance factor: Not easy to make an audio loop with instagram reels on the phone. I cut the video length to loop an exact length of audio, but instagram seems to have cropped the video a bit, and they don’t appear to give fine grained control over the loop start and stop time…or, perhaps it is possible, but also annoying to spend any time on.</p>
</section>
<section id="youtube-shorts" class="level2">
<h2 class="anchored" data-anchor-id="youtube-shorts">Youtube shorts</h2>
<p>I took the spotify canvas shorts, which were only 7 seconds long, and extended them to 30 seconds…with some more better after effects vfx too ;)</p>
<p>This is a playlist of all them. It was pretty fun to make these. I’ll probably make more for other tracks at some point.</p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/videoseries?si=hujwZ5LEb0flabKB&amp;list=PLDI1NnDZMA8OmYG14hXchvwxpPBypxtxf" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>
<p>Nuisance factor: although distrokid did make a youtube channel for me, and I do have control over it, the music does not show up as an option to pair with youtube shorts. Not sure why.</p>



</section>

 ]]></description>
  <category>New Release</category>
  <category>Basement Tapes 1</category>
  <category>distrokid</category>
  <guid>https://homophony.quest/blog/52_2_19_24_bt_album/</guid>
  <pubDate>Tue, 20 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/52_2_19_24_bt_album/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>VO: We will go for a ride to the beach</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/53_2_20_24_beach/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"synthesizer beach. beach view. Sunset. looking out onto the beach. 80s cartoon. linocut. synthesizer music."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1920</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1080</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="cover.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://homophony.quest/blog/53_2_20_24_beach/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></a></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>synthesizer beach. beach view. Sunset. looking out onto the beach. 80s cartoon. linocut. synthesizer music. - dreamshaper-xl-turbo</p>
</div></div><p>I didn’t realize that all of the tracks from my albums are selectable on instagram as music background for instagram reels.</p>
<p>I’ve occasionally posted some reels, mostly with strange video fx stuff that I was messing about with. I mostly never post reels.</p>
<p>But, I do like making strange little video clips. And, I now I could do that for each of the tracks on the older albums. That could be fun. Will it though? I need to find out.</p>
<p>I chose the song “we will go for a ride to the beach” from <a href="https://homophony.quest/music/VO.html">VO</a>. This was made in when I was deeply cloistered in my basement, dreaming of going outside once again someday in the future, to the beach.</p>
<p>Here’s the song if you’re curious. Let’s try a youtube embed this time</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lZNZV-wzJlM?si=SLo9afvTtSOiE9vq" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>
<p>I’m not sure how to change the video for these youtube tracks that are generated by distrokid. I do have control over this youtube channel, but these tracks are all auto-populated and I can’t seem to change them. Anyhow.</p>
<section id="basic-animation-idea" class="level2">
<h2 class="anchored" data-anchor-id="basic-animation-idea">Basic animation idea</h2>
<p>I used the python code at the top of this post to generate some images from <a href="https://huggingface.co/Lykon/dreamshaper-xl-turbo">Dreamshaper-xl-turbo</a>. I have a local copy of dreamshaper and I sometimes use it to make pictures with synthesizers in it.</p>
<p>The prompt for these was: “synthesizer beach. beach view. Sunset. looking out onto the beach. 80s cartoon. linocut. synthesizer music”. The file name for each has info about the random seed used. I only made 8 of them, but it would go on forever making variations of things that look like this.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="4">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="my-gallery" title="synth_21_11.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_21_11.jpeg" class="img-fluid figure-img" alt="synth_21_11.jpeg"></a></p>
<figcaption>synth_21_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_21_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="my-gallery" title="synth_21_6.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_21_6.jpeg" class="img-fluid figure-img" alt="synth_21_6.jpeg"></a></p>
<figcaption>synth_21_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="my-gallery" title="synth_22_11.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_22_11.jpeg" class="img-fluid figure-img" alt="synth_22_11.jpeg"></a></p>
<figcaption>synth_22_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_22_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="my-gallery" title="synth_22_6.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_22_6.jpeg" class="img-fluid figure-img" alt="synth_22_6.jpeg"></a></p>
<figcaption>synth_22_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="my-gallery" title="synth_23_11.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_23_11.jpeg" class="img-fluid figure-img" alt="synth_23_11.jpeg"></a></p>
<figcaption>synth_23_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_23_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="my-gallery" title="synth_23_6.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_23_6.jpeg" class="img-fluid figure-img" alt="synth_23_6.jpeg"></a></p>
<figcaption>synth_23_6.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_11.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="my-gallery" title="synth_24_11.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_24_11.jpeg" class="img-fluid figure-img" alt="synth_24_11.jpeg"></a></p>
<figcaption>synth_24_11.jpeg</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synth_24_6.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="my-gallery" title="synth_24_6.jpeg"><img src="https://homophony.quest/blog/53_2_20_24_beach/images/synth_24_6.jpeg" class="img-fluid figure-img" alt="synth_24_6.jpeg"></a></p>
<figcaption>synth_24_6.jpeg</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>These are just OK, good enough for a quick animation project. Not sure what I’m going to do one/all of them yet, but it will involve something, probably in Adobe Fresco where I can cut them up, and do a quick animation.</p>
<p>Some very light animation was had to get the waves moving a bit. Then some colorization with after effects.</p>
<p>Tried to get the length to correspond to a musical snippet from this song, but that wasn’t super easy. I nailed it in after effects, but I’m not totally sure how instagram reels works for getting the size of a loop, so it got a bit clunky at the end.</p>
<div style="width:50%;">
<blockquote class="instagram-media blockquote" data-instgrm-captioned="" data-instgrm-permalink="https://www.instagram.com/reel/C3lEF6gOW-M/?utm_source=ig_embed&amp;utm_campaign=loading" data-instgrm-version="14" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:540px; min-width:326px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);">
<div style="padding:16px;">
<a href="https://www.instagram.com/reel/C3lEF6gOW-M/?utm_source=ig_embed&amp;utm_campaign=loading" style=" background:#FFFFFF; line-height:0; padding:0 0; text-align:center; text-decoration:none; width:100%;" target="_blank">
<div style=" display: flex; flex-direction: row; align-items: center;">
<div style="background-color: #F4F4F4; border-radius: 50%; flex-grow: 0; height: 40px; margin-right: 14px; width: 40px;">

</div>
<div style="display: flex; flex-direction: column; flex-grow: 1; justify-content: center;">
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; margin-bottom: 6px; width: 100px;">

</div>
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; width: 60px;">

</div>
</div>
</div>
<div style="padding: 19% 0;">

</div>
<div style="display:block; height:50px; margin:0 auto 12px; width:50px;">
<svg width="50px" height="50px" viewbox="0 0 60 60" version="1.1" xmlns="https://www.w3.org/2000/svg" xlink="https://www.w3.org/1999/xlink">
<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(-511.000000, -20.000000)" fill="#000000"><g><path d="M556.869,30.41 C554.814,30.41 553.148,32.076 553.148,34.131 C553.148,36.186 554.814,37.852 556.869,37.852 C558.924,37.852 560.59,36.186 560.59,34.131 C560.59,32.076 558.924,30.41 556.869,30.41 M541,60.657 C535.114,60.657 530.342,55.887 530.342,50 C530.342,44.114 535.114,39.342 541,39.342 C546.887,39.342 551.658,44.114 551.658,50 C551.658,55.887 546.887,60.657 541,60.657 M541,33.886 C532.1,33.886 524.886,41.1 524.886,50 C524.886,58.899 532.1,66.113 541,66.113 C549.9,66.113 557.115,58.899 557.115,50 C557.115,41.1 549.9,33.886 541,33.886 M565.378,62.101 C565.244,65.022 564.756,66.606 564.346,67.663 C563.803,69.06 563.154,70.057 562.106,71.106 C561.058,72.155 560.06,72.803 558.662,73.347 C557.607,73.757 556.021,74.244 553.102,74.378 C549.944,74.521 548.997,74.552 541,74.552 C533.003,74.552 532.056,74.521 528.898,74.378 C525.979,74.244 524.393,73.757 523.338,73.347 C521.94,72.803 520.942,72.155 519.894,71.106 C518.846,70.057 518.197,69.06 517.654,67.663 C517.244,66.606 516.755,65.022 516.623,62.101 C516.479,58.943 516.448,57.996 516.448,50 C516.448,42.003 516.479,41.056 516.623,37.899 C516.755,34.978 517.244,33.391 517.654,32.338 C518.197,30.938 518.846,29.942 519.894,28.894 C520.942,27.846 521.94,27.196 523.338,26.654 C524.393,26.244 525.979,25.756 528.898,25.623 C532.057,25.479 533.004,25.448 541,25.448 C548.997,25.448 549.943,25.479 553.102,25.623 C556.021,25.756 557.607,26.244 558.662,26.654 C560.06,27.196 561.058,27.846 562.106,28.894 C563.154,29.942 563.803,30.938 564.346,32.338 C564.756,33.391 565.244,34.978 565.378,37.899 C565.522,41.056 565.552,42.003 565.552,50 C565.552,57.996 565.522,58.943 565.378,62.101 M570.82,37.631 C570.674,34.438 570.167,32.258 569.425,30.349 C568.659,28.377 567.633,26.702 565.965,25.035 C564.297,23.368 562.623,22.342 560.652,21.575 C558.743,20.834 556.562,20.326 553.369,20.18 C550.169,20.033 549.148,20 541,20 C532.853,20 531.831,20.033 528.631,20.18 C525.438,20.326 523.257,20.834 521.349,21.575 C519.376,22.342 517.703,23.368 516.035,25.035 C514.368,26.702 513.342,28.377 512.574,30.349 C511.834,32.258 511.326,34.438 511.181,37.631 C511.035,40.831 511,41.851 511,50 C511,58.147 511.035,59.17 511.181,62.369 C511.326,65.562 511.834,67.743 512.574,69.651 C513.342,71.625 514.368,73.296 516.035,74.965 C517.703,76.634 519.376,77.658 521.349,78.425 C523.257,79.167 525.438,79.673 528.631,79.82 C531.831,79.965 532.853,80.001 541,80.001 C549.148,80.001 550.169,79.965 553.369,79.82 C556.562,79.673 558.743,79.167 560.652,78.425 C562.623,77.658 564.297,76.634 565.965,74.965 C567.633,73.296 568.659,71.625 569.425,69.651 C570.167,67.743 570.674,65.562 570.82,62.369 C570.966,59.17 571,58.147 571,50 C571,41.851 570.966,40.831 570.82,37.631"></path></g></g></g>
</svg>
</div>
<div style="padding-top: 8px;">
<div style=" color:#3897f0; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:550; line-height:18px;">
View this post on Instagram
</div>
</div>
<div style="padding: 12.5% 0;">

</div>
<div style="display: flex; flex-direction: row; margin-bottom: 14px; align-items: center;">
<div>
<div style="background-color: #F4F4F4; border-radius: 50%; height: 12.5px; width: 12.5px; transform: translateX(0px) translateY(7px);">

</div>
<div style="background-color: #F4F4F4; height: 12.5px; transform: rotate(-45deg) translateX(3px) translateY(1px); width: 12.5px; flex-grow: 0; margin-right: 14px; margin-left: 2px;">

</div>
<div style="background-color: #F4F4F4; border-radius: 50%; height: 12.5px; width: 12.5px; transform: translateX(9px) translateY(-18px);">

</div>
</div>
<div style="margin-left: 8px;">
<div style=" background-color: #F4F4F4; border-radius: 50%; flex-grow: 0; height: 20px; width: 20px;">

</div>
<div style=" width: 0; height: 0; border-top: 2px solid transparent; border-left: 6px solid #f4f4f4; border-bottom: 2px solid transparent; transform: translateX(16px) translateY(-4px) rotate(30deg)">

</div>
</div>
<div style="margin-left: auto;">
<div style=" width: 0px; border-top: 8px solid #F4F4F4; border-right: 8px solid transparent; transform: translateY(16px);">

</div>
<div style=" background-color: #F4F4F4; flex-grow: 0; height: 12px; width: 16px; transform: translateY(-4px);">

</div>
<div style=" width: 0; height: 0; border-top: 8px solid #F4F4F4; border-left: 8px solid transparent; transform: translateY(-4px) translateX(8px);">

</div>
</div>
</div>
<div style="display: flex; flex-direction: column; flex-grow: 1; justify-content: center; margin-bottom: 24px;">
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; margin-bottom: 6px; width: 224px;">

</div>
<div style=" background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; width: 144px;">

</div>
</div>
</a>
<p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;">
<a href="https://www.instagram.com/reel/C3lEF6gOW-M/?utm_source=ig_embed&amp;utm_campaign=loading" style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none;" target="_blank">A post shared by Matt Crump (<span class="citation" data-cites="mattcrumplab">@mattcrumplab</span>)</a>
</p>
</div>
</blockquote>
<script async="" src="//www.instagram.com/embed.js"></script>
<div>















</div></div></section>

 ]]></description>
  <category>VO</category>
  <category>video</category>
  <guid>https://homophony.quest/blog/53_2_20_24_beach/</guid>
  <pubDate>Tue, 20 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/53_2_20_24_beach/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Airwolf trap remix</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/51_2_18_24_airwolf/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chunky square wave. house beats. convolution reverb. A little dark analog delay. lots of stereo. busy. synthesizers. megazord. linocut"</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://homophony.quest/blog/51_2_18_24_airwolf/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Screenshot from Airwolf for NES</p>
</div></div><p>Continuing in the glorious tradition of screwing around with NES midi files.</p>
<section id="airwolf-trap-remix" class="level2">
<h2 class="anchored" data-anchor-id="airwolf-trap-remix">Airwolf trap remix</h2>
<p><audio controls=""> <source src="Airwolf.mp3" type="audio/wav"> </audio></p>


</section>

 ]]></description>
  <category>airwolf</category>
  <category>nes</category>
  <category>midi remix</category>
  <guid>https://homophony.quest/blog/51_2_18_24_airwolf/</guid>
  <pubDate>Sun, 18 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/51_2_18_24_airwolf/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Composition tests</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/50_2_16_24_comps/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chunky square wave. house beats. convolution reverb. A little dark analog delay. lots of stereo. busy. synthesizers. megazord. linocut"</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://homophony.quest/blog/50_2_16_24_comps/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>“Chunky square wave. house beats. convolution reverb. A little dark analog delay. lots of stereo. busy. synthesizers. megazord. linocut”</p>
<hr>
<p>This image was produced by dreamshaper-xl-turbo using the above prompt, and should be reproducible with the source code.</p>
</div></div><section id="comp-1" class="level2">
<h2 class="anchored" data-anchor-id="comp-1">Comp 1</h2>
<p>Some tests.</p>
<p>-add drums and synth voices</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(midiblender)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pyramidi)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(fluidsynth)</span>
<span id="cb2-5"></span>
<span id="cb2-6">all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb2-7"></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb2-9">  bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> </span>
<span id="cb2-10">  repeat_bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-11">  possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb2-12">  note_interval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb2-13">  note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb2-14">  </span>
<span id="cb2-15">  track_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_1_kick =</span></span>
<span id="cb2-16">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb2-17">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb2-18">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb2-19">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb2-20">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb2-21">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-22">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-23">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb2-24">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb2-25">                           ),</span>
<span id="cb2-26">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_2_snare =</span></span>
<span id="cb2-27">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb2-28">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb2-29">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb2-30">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb2-31">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb2-32">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-33">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb2-34">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb2-35">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb2-36">                          ),</span>
<span id="cb2-37">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_3_cymb =</span></span>
<span id="cb2-38">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb2-39">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb2-40">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb2-41">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb2-42">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb2-43">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb2-44">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb2-45">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb2-46">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb2-47">                          ),</span>
<span id="cb2-48">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_4_synth =</span></span>
<span id="cb2-49">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb2-50">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb2-51">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb2-52">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb2-53">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb2-54">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb2-55">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-56">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-57">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb2-58">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb2-59">                          ),</span>
<span id="cb2-60">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_5_synth =</span></span>
<span id="cb2-61">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb2-62">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb2-63">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb2-64">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb2-65">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb2-66">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb2-67">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-68">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb2-69">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb2-70">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb2-71">                          )</span>
<span id="cb2-72">  )</span>
<span id="cb2-73">                       </span>
<span id="cb2-74">                           </span>
<span id="cb2-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop for each track</span></span>
<span id="cb2-76"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {</span>
<span id="cb2-77">  </span>
<span id="cb2-78">  compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb2-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb2-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb2-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb2-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb2-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()</span>
<span id="cb2-84">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-85">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use euclidean rhythm</span></span>
<span id="cb2-86">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-87">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb2-88">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(</span>
<span id="cb2-89">        bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars,</span>
<span id="cb2-90">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_beats, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb2-91">                            possible_time_steps,</span>
<span id="cb2-92">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-93">      )),</span>
<span id="cb2-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_notes,</span>
<span id="cb2-95">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> possible_time_steps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars),</span>
<span id="cb2-96">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>key_vector</span>
<span id="cb2-97">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-98">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-99">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb2-100">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb2-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_interval,</span>
<span id="cb2-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_duration</span>
<span id="cb2-104">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-105">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-106">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb2-107">    tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),</span>
<span id="cb2-108">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,</span>
<span id="cb2-109">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-110">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-111">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb2-112">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel)</span>
<span id="cb2-113">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######################</span></span>
<span id="cb2-114">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># End composition </span></span>
<span id="cb2-115">  </span>
<span id="cb2-116">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#######################</span></span>
<span id="cb2-117">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add composition to a new midi df</span></span>
<span id="cb2-118">  new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb2-119">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-120">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-121">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb2-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb2-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb2-126">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-127">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program,</span>
<span id="cb2-128">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-129">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-130">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composition added here</span></span>
<span id="cb2-131">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb2-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb2-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb2-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb2-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb2-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb2-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel,</span>
<span id="cb2-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>L<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">112</span>L,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace=</span>T)</span>
<span id="cb2-139">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#velocity = 64</span></span>
<span id="cb2-140">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-141">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-142">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-143">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> velocity,</span>
<span id="cb2-144">                                type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set current track number</span></span>
<span id="cb2-145">  </span>
<span id="cb2-146">  all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(all_tracks,new_midi_df)</span>
<span id="cb2-147">  </span>
<span id="cb2-148">}</span>
<span id="cb2-149"></span>
<span id="cb2-150"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb2-151"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb2-152">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb2-153"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb2-154">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb2-155"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb2-156">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(all_tracks)</span>
<span id="cb2-157"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb2-158">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-C.mid"</span>)</span>
<span id="cb2-159"></span>
<span id="cb2-160"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># play</span></span>
<span id="cb2-161">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_play</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-C.mid"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>)</span>
<span id="cb2-162"></span>
<span id="cb2-163"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#bounce</span></span>
<span id="cb2-164">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-C.mid"</span>,</span>
<span id="cb2-165">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb2-166">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-D.mp3"</span>)</span></code></pre></div>
</details>
</div>
<p><audio controls=""> <source src="TE-EP-133-D.mp3" type="audio/wav"> </audio></p>
</section>
<section id="comp-2" class="level2">
<h2 class="anchored" data-anchor-id="comp-2">Comp 2</h2>
<ul>
<li>get super basic, increase repetition, 4 on floor</li>
<li>increase gain</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(midiblender)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pyramidi)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(fluidsynth)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb4-4">  bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> </span>
<span id="cb4-5">  repeat_bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-6">  possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb4-7">  note_interval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb4-8">  note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb4-9">  </span>
<span id="cb4-10">  track_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_1_kick =</span></span>
<span id="cb4-11">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb4-12">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb4-13">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb4-14">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb4-15">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb4-16">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-17">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-18">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb4-19">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb4-20">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb4-21">                           ),</span>
<span id="cb4-22">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_2_snare =</span></span>
<span id="cb4-23">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb4-24">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb4-25">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb4-26">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb4-27">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb4-28">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-29">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-30">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb4-31">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb4-32">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb4-33">                          ),</span>
<span id="cb4-34">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_3_cymb =</span></span>
<span id="cb4-35">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb4-36">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb4-37">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb4-38">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb4-39">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb4-40">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-41">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-42">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb4-43">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb4-44">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb4-45">                          ),</span>
<span id="cb4-46">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_4_synth =</span></span>
<span id="cb4-47">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb4-48">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb4-49">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb4-50">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb4-51">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb4-52">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb4-53">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-54">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-55">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb4-56">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T),</span>
<span id="cb4-57">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars))</span>
<span id="cb4-58">                          ),</span>
<span id="cb4-59">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_5_synth =</span></span>
<span id="cb4-60">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb4-61">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb4-62">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb4-63">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb4-64">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb4-65">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb4-66">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-67">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-68">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb4-69">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T),</span>
<span id="cb4-70">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars))</span>
<span id="cb4-71">                          )</span>
<span id="cb4-72">  )</span>
<span id="cb4-73">                       </span>
<span id="cb4-74">                           </span>
<span id="cb4-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop for each track</span></span>
<span id="cb4-76"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {</span>
<span id="cb4-77">  </span>
<span id="cb4-78">  compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()</span>
<span id="cb4-85">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-86">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use euclidean rhythm</span></span>
<span id="cb4-87">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-88">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb4-89">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(</span>
<span id="cb4-90">        bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars,</span>
<span id="cb4-91">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_beats, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb4-92">                            possible_time_steps,</span>
<span id="cb4-93">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-94">      )),</span>
<span id="cb4-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_notes,</span>
<span id="cb4-96">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> possible_time_steps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars),</span>
<span id="cb4-97">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>key_vector,</span>
<span id="cb4-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>velocity </span>
<span id="cb4-99">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-100">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-101">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb4-102">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb4-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_interval,</span>
<span id="cb4-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_duration</span>
<span id="cb4-106">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-107">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-108">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb4-109">    tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),</span>
<span id="cb4-110">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,</span>
<span id="cb4-111">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-112">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-113">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-114">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel)</span>
<span id="cb4-115">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######################</span></span>
<span id="cb4-116">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># End composition </span></span>
<span id="cb4-117">  </span>
<span id="cb4-118">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#######################</span></span>
<span id="cb4-119">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add composition to a new midi df</span></span>
<span id="cb4-120">  new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb4-121">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-122">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-123">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb4-128">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-129">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program,</span>
<span id="cb4-130">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-131">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-132">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composition added here</span></span>
<span id="cb4-133">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb4-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb4-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb4-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb4-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb4-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel,</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>velocity</span>
<span id="cb4-141">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#velocity = 64</span></span>
<span id="cb4-142">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-143">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-144">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> velocity,</span>
<span id="cb4-145">                                type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb4-146">  </span>
<span id="cb4-147">  all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(all_tracks,new_midi_df)</span>
<span id="cb4-148">  </span>
<span id="cb4-149">}</span>
<span id="cb4-150"></span>
<span id="cb4-151"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb4-152"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb4-153">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb4-154"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb4-155">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb4-156"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb4-157">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(all_tracks)</span>
<span id="cb4-158"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb4-159">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-E.mid"</span>)</span>
<span id="cb4-160"></span>
<span id="cb4-161"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># play</span></span>
<span id="cb4-162">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_play</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-E.mid"</span>,</span>
<span id="cb4-163">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb4-164">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.gain'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#bounce</span></span>
<span id="cb5-2">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-E.mid"</span>,</span>
<span id="cb5-3">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb5-4">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-E_synth_Eb.mp3"</span>,</span>
<span id="cb5-5">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.gain'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</details>
</div>
<p>This ended up being fun. I bounced a couple 24 bar drum tracks to ableton generated from this script. And, a simple synth track. Then used that source material to get this going.</p>
<p><audio controls=""> <source src="EP-133_E_song.mp3" type="audio/wav"> </audio></p>
</section>
<section id="comp-3" class="level2">
<h2 class="anchored" data-anchor-id="comp-3">Comp 3</h2>
<ul>
<li>Not sure yet</li>
<li>try something similar to Comp 2</li>
<li>increase gain</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(midiblender)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pyramidi)</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(fluidsynth)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb7-4">bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> </span>
<span id="cb7-5">repeat_bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-6">possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb7-7">note_interval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb7-8">note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb7-9"></span>
<span id="cb7-10">track_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb7-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_1_kick =</span></span>
<span id="cb7-12">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb7-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb7-14">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb7-15">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb7-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb7-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb7-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb7-22">     ),</span>
<span id="cb7-23"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_2_snare =</span></span>
<span id="cb7-24">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb7-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb7-26">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb7-27">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb7-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb7-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb7-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb7-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb7-34">    ),</span>
<span id="cb7-35"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_3_cymb =</span></span>
<span id="cb7-36">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb7-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb7-38">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb7-39">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb7-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb7-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb7-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb7-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb7-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb7-46">    ),</span>
<span id="cb7-47"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_4_synth =</span></span>
<span id="cb7-48">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb7-49">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb7-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb7-51">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb7-52">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb7-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb7-54">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb7-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb7-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb7-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T),</span>
<span id="cb7-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars))</span>
<span id="cb7-59">    ),</span>
<span id="cb7-60"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_5_synth =</span></span>
<span id="cb7-61">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb7-62">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb7-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb7-64">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb7-65">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb7-66">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb7-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb7-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb7-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb7-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T),</span>
<span id="cb7-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars))</span>
<span id="cb7-72">    )</span>
<span id="cb7-73">)</span>
<span id="cb7-74">             </span>
<span id="cb7-75">                           </span>
<span id="cb7-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop for each track</span></span>
<span id="cb7-77"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {</span>
<span id="cb7-78">  </span>
<span id="cb7-79">  compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb7-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()</span>
<span id="cb7-86">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-87">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use euclidean rhythm</span></span>
<span id="cb7-88">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-89">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb7-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(</span>
<span id="cb7-91">        bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars,</span>
<span id="cb7-92">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_beats, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb7-93">                            possible_time_steps,</span>
<span id="cb7-94">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-95">      )),</span>
<span id="cb7-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_notes,</span>
<span id="cb7-97">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> possible_time_steps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars),</span>
<span id="cb7-98">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>key_vector,</span>
<span id="cb7-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>velocity </span>
<span id="cb7-100">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-101">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb7-103">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb7-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb7-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_interval,</span>
<span id="cb7-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_duration</span>
<span id="cb7-107">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-108">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-109">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb7-110">    tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),</span>
<span id="cb7-111">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,</span>
<span id="cb7-112">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-113">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-114">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb7-115">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel)</span>
<span id="cb7-116">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######################</span></span>
<span id="cb7-117">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># End composition </span></span>
<span id="cb7-118">  </span>
<span id="cb7-119">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#######################</span></span>
<span id="cb7-120">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add composition to a new midi df</span></span>
<span id="cb7-121">  new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb7-122">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-123">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-124">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb7-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb7-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb7-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb7-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb7-129">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-130">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program,</span>
<span id="cb7-131">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-132">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-133">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composition added here</span></span>
<span id="cb7-134">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb7-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb7-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb7-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb7-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb7-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb7-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel,</span>
<span id="cb7-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>velocity</span>
<span id="cb7-142">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#velocity = 64</span></span>
<span id="cb7-143">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-144">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-145">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> velocity,</span>
<span id="cb7-146">                                type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb7-147">  </span>
<span id="cb7-148">  all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(all_tracks,new_midi_df)</span>
<span id="cb7-149">  </span>
<span id="cb7-150">}</span>
<span id="cb7-151"></span>
<span id="cb7-152"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb7-153"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb7-154">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb7-155"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb7-156">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb7-157"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb7-158">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(all_tracks)</span>
<span id="cb7-159"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb7-160">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F_samples/TE-EP-133-FsynthA.mid"</span>)</span>
<span id="cb7-161"></span>
<span id="cb7-162"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># play</span></span>
<span id="cb7-163">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_play</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F_samples/TE-EP-133-FsynthA.mid"</span>,</span>
<span id="cb7-164">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb7-165">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.gain'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#bounce</span></span>
<span id="cb8-2">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F_samples/TE-EP-133-FsynthA.mid"</span>,</span>
<span id="cb8-3">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb8-4">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F_samples/TE-EP-133-FsynthA.mp3"</span>,</span>
<span id="cb8-5">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.gain'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</details>
</div>
<p>Fun was had.</p>
</section>
<section id="comp-4" class="level2">
<h2 class="anchored" data-anchor-id="comp-4">Comp 4</h2>
<ul>
<li>Going back to super basic</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(midiblender)</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pyramidi)</span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(fluidsynth)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb10-4">bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> </span>
<span id="cb10-5">repeat_bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb10-6">possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb10-7">note_interval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb10-8">note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb10-9"></span>
<span id="cb10-10">track_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb10-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_1_kick =</span></span>
<span id="cb10-12">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb10-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb10-14">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb10-15">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb10-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb10-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb10-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb10-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb10-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb10-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb10-22">     ),</span>
<span id="cb10-23"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_2_snare =</span></span>
<span id="cb10-24">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb10-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb10-26">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb10-27">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb10-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb10-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb10-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb10-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb10-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb10-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb10-34">    ),</span>
<span id="cb10-35"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_3_cymb =</span></span>
<span id="cb10-36">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb10-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb10-38">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb10-39">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb10-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb10-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb10-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb10-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb10-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb10-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb10-46">    ),</span>
<span id="cb10-47"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_4_synth =</span></span>
<span id="cb10-48">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb10-49">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb10-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb10-51">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb10-52">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb10-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb10-54">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb10-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb10-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb10-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T),</span>
<span id="cb10-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars))</span>
<span id="cb10-59">    ),</span>
<span id="cb10-60"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_5_synth =</span></span>
<span id="cb10-61">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>)),   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb10-62">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb10-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb10-64">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb10-65">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb10-66">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb10-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb10-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb10-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_interval =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb10-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>), possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T),</span>
<span id="cb10-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> (possible_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars))</span>
<span id="cb10-72">    )</span>
<span id="cb10-73">)</span>
<span id="cb10-74">             </span>
<span id="cb10-75">                           </span>
<span id="cb10-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop for each track</span></span>
<span id="cb10-77"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {</span>
<span id="cb10-78">  </span>
<span id="cb10-79">  compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb10-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb10-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb10-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb10-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb10-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb10-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()</span>
<span id="cb10-86">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-87">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use euclidean rhythm</span></span>
<span id="cb10-88">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-89">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb10-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(</span>
<span id="cb10-91">        bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars,</span>
<span id="cb10-92">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_beats, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb10-93">                            possible_time_steps,</span>
<span id="cb10-94">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb10-95">      )),</span>
<span id="cb10-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_notes,</span>
<span id="cb10-97">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> possible_time_steps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars),</span>
<span id="cb10-98">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>key_vector,</span>
<span id="cb10-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>velocity </span>
<span id="cb10-100">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-101">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb10-103">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb10-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb10-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_interval,</span>
<span id="cb10-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note_duration</span>
<span id="cb10-107">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-108">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-109">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb10-110">    tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),</span>
<span id="cb10-111">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,</span>
<span id="cb10-112">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-113">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-114">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb10-115">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel)</span>
<span id="cb10-116">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######################</span></span>
<span id="cb10-117">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># End composition </span></span>
<span id="cb10-118">  </span>
<span id="cb10-119">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#######################</span></span>
<span id="cb10-120">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add composition to a new midi df</span></span>
<span id="cb10-121">  new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb10-122">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-123">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-124">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb10-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb10-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb10-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb10-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb10-129">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-130">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program,</span>
<span id="cb10-131">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-132">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-133">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composition added here</span></span>
<span id="cb10-134">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb10-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb10-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb10-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb10-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb10-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb10-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel,</span>
<span id="cb10-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>velocity</span>
<span id="cb10-142">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#velocity = 64</span></span>
<span id="cb10-143">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-144">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-145">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> velocity,</span>
<span id="cb10-146">                                type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb10-147">  </span>
<span id="cb10-148">  all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(all_tracks,new_midi_df)</span>
<span id="cb10-149">  </span>
<span id="cb10-150">}</span>
<span id="cb10-151"></span>
<span id="cb10-152"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb10-153"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb10-154">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb10-155"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb10-156">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb10-157"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb10-158">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(all_tracks)</span>
<span id="cb10-159"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb10-160">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_samples/TE-EP-133-Gsynth.mid"</span>)</span>
<span id="cb10-161"></span>
<span id="cb10-162"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># play</span></span>
<span id="cb10-163">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_play</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_samples/TE-EP-133-Gsynth.mid"</span>,</span>
<span id="cb10-164">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb10-165">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.gain'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#bounce</span></span>
<span id="cb11-2">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_samples/TE-EP-133-Gsynth.mid"</span>,</span>
<span id="cb11-3">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb11-4">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G_samples/TE-EP-133-Gsynth.mp3"</span>,</span>
<span id="cb11-5">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.gain'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
</details>
</div>
<p>Fun was had.</p>


</section>

 ]]></description>
  <category>midiblender</category>
  <category>soundfont</category>
  <category>fluidsynth</category>
  <guid>https://homophony.quest/blog/50_2_16_24_comps/</guid>
  <pubDate>Sat, 17 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/50_2_16_24_comps/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Soundfonts and {rsoundfont}!</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/49_2_15_24_r_soundfonts/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a synthesizer made out of water. 3d. white background. super cool."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://homophony.quest/blog/49_2_15_24_r_soundfonts/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Sound Blaster AWE 64</p>
</div></div><p>Soundfonts…wow. In some sense this format is totally new to me. I had to download some to get fluidsynth to play sounds, and that’s about all I knew about them.</p>
<p>After perusing <a href="https://en.wikipedia.org/wiki/SoundFont">soundfonts on wikipedia</a> I learned that the awesome sounds of my childhood, from the Sound Blaster AWE32 soundcard that blew my freaking mind as a kid, was soundfonts.</p>
<p>Last night I downloaded a whole bunch of soundfont collections, because why not. And, then I realized that I didn’t know anything about the <code>.sf2</code> format, soundfont file structure, how to quickly audition different soundfonts, etc.</p>
<p>So, I am on a soundfont journey.</p>
<p>I was very excited to learn that <a href="https://coolbutuseless.github.io">coolbutuseless</a> made a package to inspect <code>.sf2</code> files, called <a href="https://github.com/coolbutuseless/rsoundfont">rsoundfont</a>. I’m testing it out a bit here.</p>
<section id="soundfont-specs" class="level2">
<h2 class="anchored" data-anchor-id="soundfont-specs">soundfont specs</h2>
<p><a href="https://www.synthfont.com/sfspec24.pdf" class="uri">https://www.synthfont.com/sfspec24.pdf</a></p>
</section>
<section id="rsoundfont-tests" class="level2">
<h2 class="anchored" data-anchor-id="rsoundfont-tests">rsoundfont tests</h2>
<p>{rsoundfont} works great. The <code>.sf2</code> file loads as a list. All of the .wav info is in R, and the <code>create_sample()</code> function makes it possible to quickly listen to a soundfont in R.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rsoundfont)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># storing all my .sf2 files here</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get a list of them</span></span>
<span id="cb2-5">sound_font_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks"</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pick one to load</span></span>
<span id="cb2-8">sf2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/"</span>,sound_font_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">37</span>]))</span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># look at stuff</span></span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#View(sf2$pdta$phdr)</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#sf2$pdta$shdr$name</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#sf2$pdta$shdr</span></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># quickly loop through different soundfonts and play them</span></span>
<span id="cb2-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sf2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pdta<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>shdr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name)){</span>
<span id="cb2-18">  samp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_sample</span>(sf2, sf2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pdta<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>shdr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name[i], <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb2-19">  audio<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">play</span>(samp)</span>
<span id="cb2-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb2-21">}</span></code></pre></div>
</details>
</div>
</section>
<section id="polyphone" class="level2">
<h2 class="anchored" data-anchor-id="polyphone">polyphone</h2>
<p>Next I discovered <a href="https://github.com/davy7125/polyphone">polyphone</a>, which is an excellent open-source soundfont editor.</p>
<p>Polyphone makes it incredibly easy to organize samples and turn them into .sf2 files.</p>
</section>
<section id="te-ep-133-k.o.-ii" class="level2">
<h2 class="anchored" data-anchor-id="te-ep-133-k.o.-ii">TE EP-133 K.O. II</h2>
<p>I recently picked up a TE EP-133 K.O. II and I love the sample on there. Using polyphone it didn’t take that much work to get the samples into <code>.sf2</code>. Which means I should be able to make some fun beat. There are a bunch of different options for organizing samples as instruments and patches, and I’m looking forward to exploring this a little bit more.</p>
</section>
<section id="killr-beatz" class="level2">
<h2 class="anchored" data-anchor-id="killr-beatz">KillR BEATZ</h2>
<p>If it is true that I possess some super inspiring samples for drums, then I should be able to make some fun beats. Let’s see:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(midiblender)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pyramidi)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(fluidsynth)</span>
<span id="cb3-5"></span>
<span id="cb3-6">all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb3-9">  bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> </span>
<span id="cb3-10">  repeat_bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-11">  possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb3-12">  note_interval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb3-13">  note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb3-14">  </span>
<span id="cb3-15">  track_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_1_kick =</span></span>
<span id="cb3-16">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb3-17">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb3-18">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb3-19">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb3-20">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb3-21">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-22">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-23">                           ),</span>
<span id="cb3-24">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_2_snare =</span></span>
<span id="cb3-25">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb3-26">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb3-27">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb3-28">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb3-29">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb3-30">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-31">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-32">                          ),</span>
<span id="cb3-33">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_3_cymb =</span></span>
<span id="cb3-34">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),  </span>
<span id="cb3-35">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb3-36">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb3-37">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> repeat_bars),</span>
<span id="cb3-38">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_beats =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb3-39">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb3-40">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb3-41">                          )</span>
<span id="cb3-42">  )</span>
<span id="cb3-43">                       </span>
<span id="cb3-44">                           </span>
<span id="cb3-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop for each track</span></span>
<span id="cb3-46"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb3-47">  </span>
<span id="cb3-48">  compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb3-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb3-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb3-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb3-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()</span>
<span id="cb3-54">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-55">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use euclidean rhythm</span></span>
<span id="cb3-56">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-57">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb3-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(</span>
<span id="cb3-59">        bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars,</span>
<span id="cb3-60">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_beats, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb3-61">                            possible_time_steps,</span>
<span id="cb3-62">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-63">      )),</span>
<span id="cb3-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_notes,</span>
<span id="cb3-65">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> possible_time_steps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>repeat_bars),</span>
<span id="cb3-66">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>key_vector</span>
<span id="cb3-67">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-68">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-69">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb3-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb3-72">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> note_interval,</span>
<span id="cb3-73">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> note_duration</span>
<span id="cb3-74">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-75">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb3-77">    tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),</span>
<span id="cb3-78">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,</span>
<span id="cb3-79">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-80">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-81">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-82">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel)</span>
<span id="cb3-83">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######################</span></span>
<span id="cb3-84">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># End composition </span></span>
<span id="cb3-85">  </span>
<span id="cb3-86">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#######################</span></span>
<span id="cb3-87">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add composition to a new midi df</span></span>
<span id="cb3-88">  new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb3-89">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-90">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-91">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb3-92">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb3-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb3-96">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-97">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program,</span>
<span id="cb3-98">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-99">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-100">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composition added here</span></span>
<span id="cb3-101">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb3-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb3-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb3-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb3-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb3-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb3-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>channel,</span>
<span id="cb3-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>L<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">112</span>L,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace=</span>T)</span>
<span id="cb3-109">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#velocity = 64</span></span>
<span id="cb3-110">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-111">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-112">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-113">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> velocity,</span>
<span id="cb3-114">                                type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set current track number</span></span>
<span id="cb3-115">  </span>
<span id="cb3-116">  all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(all_tracks,new_midi_df)</span>
<span id="cb3-117">  </span>
<span id="cb3-118">}</span>
<span id="cb3-119"></span>
<span id="cb3-120"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb3-121"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb3-122">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb3-123"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb3-124">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb3-125"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb3-126">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(all_tracks)</span>
<span id="cb3-127"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb3-128">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-B.mid"</span>)</span>
<span id="cb3-129"></span>
<span id="cb3-130"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># play</span></span>
<span id="cb3-131">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_play</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-B.mid"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>)</span>
<span id="cb3-132"></span>
<span id="cb3-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#bounce</span></span>
<span id="cb3-134">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-B.mid"</span>,</span>
<span id="cb3-135">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/TE-EP-133-A.sf2"</span>,</span>
<span id="cb3-136">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TE-EP-133-B.mp3"</span>)</span></code></pre></div>
</details>
</div>
<p><audio controls=""> <source src="TE-EP-133-B_01.mp3" type="audio/wav"> </audio></p>
<p>Look out aphex twin.</p>
<hr>
<p>Here’s a blend of those beats with mario for some more midi mangling fun.</p>
<p><audio controls=""> <source src="mario_TE.mp3" type="audio/wav"> </audio></p>


</section>

 ]]></description>
  <category>midiblender</category>
  <category>soundfont</category>
  <category>fluidsynth</category>
  <guid>https://homophony.quest/blog/49_2_15_24_r_soundfonts/</guid>
  <pubDate>Fri, 16 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/49_2_15_24_r_soundfonts/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Testing out {fluidsynth} for R!</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/48_2_15_24_r_fluid_synth/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a synthesizer made out of water. 3d. white background. super cool."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://homophony.quest/blog/48_2_15_24_r_fluid_synth/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>a synthesizer made out of water. 3d. white background. super cool. - Dreamshaper</p>
</div></div><p>Thanks to <a href="https://github.com/jeroen">Jeroen Ooms</a> and <a href="https://ropensci.org">rOpenSci</a>, there is a new {fluidsynth} package with bindings for R!</p>
<p>Here’s the github repo: <a href="https://github.com/ropensci/fluidsynth/" class="uri">https://github.com/ropensci/fluidsynth/</a></p>
<p>The package is only four days old and could change, but it is working for me!</p>
<section id="playback-midi-locally" class="level2">
<h2 class="anchored" data-anchor-id="playback-midi-locally">playback midi locally</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(fluidsynth)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this works for local playback!</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_play</span>(</span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"the-moon.mid"</span>,</span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/FluidR3_GM.sf2"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">audio.driver =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(),</span>
<span id="cb2-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">progress =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interactive</span>()</span>
<span id="cb2-11">)</span></code></pre></div>
</details>
</div>
</section>
<section id="write-midi-to-wav" class="level2">
<h2 class="anchored" data-anchor-id="write-midi-to-wav">write midi to wav</h2>
<p>I’m on a mac m2. The midi_convert function produces a wav file that will not play. However, the {av} package does successfully convert the wav file to a listenable mp3. Glad it works out in the end.</p>
<p>I’m not sure why the wav file isn’t rendering as playable. I wonder if it isn’t finding my installation of libsndfile, and the wav file is being rendered as raw?</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(</span>
<span id="cb3-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"the-moon.mid"</span>,</span>
<span id="cb3-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/FluidR3_GM.sf2"</span>,</span>
<span id="cb3-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output.wav"</span>,</span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">audio.driver =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coreaudio"</span>,</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">audio.file.format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"double"</span>,</span>
<span id="cb3-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">audio.file.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wav"</span>),</span>
<span id="cb3-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">progress =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interactive</span>()</span>
<span id="cb3-10">)</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(</span>
<span id="cb3-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"the-moon.mid"</span>,</span>
<span id="cb3-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">soundfont =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Library/Audio/Sounds/Banks/FluidR3_GM.sf2"</span>,</span>
<span id="cb3-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output.wav"</span>,</span>
<span id="cb3-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.sample-rate'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22050</span>),</span>
<span id="cb3-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">progress =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interactive</span>()</span>
<span id="cb3-18">)</span>
<span id="cb3-19"></span>
<span id="cb3-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.sample-rate'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22050</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lowquality.wav'</span>)</span>
<span id="cb3-21"></span>
<span id="cb3-22">av<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">av_audio_convert</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output.wav"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output.mp3"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="midi-to-mp3-all-night-long" class="level2">
<h2 class="anchored" data-anchor-id="midi-to-mp3-all-night-long">midi to mp3 All night long</h2>
<p>And now it is really this easy!</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">midi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"generaluser-gs/midi/All_Night_Long.mid"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fluidsynth"</span>)</span>
<span id="cb4-2">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(midi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'all_night_long.mp3'</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="testing-faster-renders" class="level2">
<h2 class="anchored" data-anchor-id="testing-faster-renders">testing faster renders</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">midi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"generaluser-gs/midi/All_Night_Long.mid"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fluidsynth"</span>)</span>
<span id="cb5-2">fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">midi_convert</span>(midi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'all_night_long.mp3'</span>,</span>
<span id="cb5-3">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">settings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'player.timing-source'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample'</span>,</span>
<span id="cb5-4">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.lock-memory'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-5">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'synth.cpu-cores'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb5-6">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb5-7">                        </span>
<span id="cb5-8">                         )</span>
<span id="cb5-9"></span>
<span id="cb5-10"></span>
<span id="cb5-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#########</span></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare render speed</span></span>
<span id="cb5-13"></span>
<span id="cb5-14">track_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All_Night_Long"</span></span>
<span id="cb5-15"></span>
<span id="cb5-16">wav_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(track_name,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".wav"</span>)</span>
<span id="cb5-17">midi_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> midi</span>
<span id="cb5-18">mp3_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(track_name,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".mp3"</span>)</span>
<span id="cb5-19"></span>
<span id="cb5-20">system_command <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fluidsynth -F {wav_name} ~/Library/Audio/Sounds/Banks/FluidR3_GM.sf2 {midi_name}'</span>)</span>
<span id="cb5-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(system_command)</span></code></pre></div>
</details>
</div>
</section>
<section id="fluid-synth-settings" class="level2">
<h2 class="anchored" data-anchor-id="fluid-synth-settings">fluid synth settings</h2>
<p>All of these fluid synth parameters can now be easily modified from R!</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(fluidsynth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fluidsynth_setting_list</span>())</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">audio.coreaudio.channel-map</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">audio.coreaudio.device</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">audio.driver</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">audio.file.endian</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">audio.file.format</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">audio.file.name</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">audio.file.type</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">audio.period-size</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">audio.periods</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">audio.portaudio.device</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">audio.realtime-prio</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">audio.sample-format</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">midi.autoconnect</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">midi.coremidi.id</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">midi.driver</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">midi.portname</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">midi.realtime-prio</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">player.reset-synth</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">player.timing-source</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">shell.port</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shell.prompt</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.audio-channels</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.audio-groups</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.chorus.active</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.chorus.depth</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.chorus.level</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.chorus.nr</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.chorus.speed</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.cpu-cores</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.default-soundfont</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.device-id</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.dynamic-sample-loading</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.effects-channels</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.effects-groups</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.gain</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.ladspa.active</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.lock-memory</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.midi-bank-select</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.midi-channels</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.min-note-length</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.overflow.age</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.overflow.important</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.overflow.important-channels</td>
<td style="text-align: left;">string</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.overflow.percussion</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.overflow.released</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.overflow.sustained</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.overflow.volume</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.polyphony</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.reverb.active</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.reverb.damp</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.reverb.level</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.reverb.room-size</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.reverb.width</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.sample-rate</td>
<td style="text-align: left;">double</td>
</tr>
<tr class="odd">
<td style="text-align: left;">synth.threadsafe-api</td>
<td style="text-align: left;">integer</td>
</tr>
<tr class="even">
<td style="text-align: left;">synth.verbose</td>
<td style="text-align: left;">integer</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

 ]]></description>
  <category>midiblender</category>
  <category>midi</category>
  <category>fluidsynth</category>
  <guid>https://homophony.quest/blog/48_2_15_24_r_fluid_synth/</guid>
  <pubDate>Thu, 15 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/48_2_15_24_r_fluid_synth/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Playing a MIDI file on a Quarto blog</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/47_2_13_24_midi_player/</link>
  <description><![CDATA[ 
<script src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0"></script>




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Player piano. piano roll. Automatic self playing piano. white background. transformers cartoon. 3d."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://homophony.quest/blog/47_2_13_24_midi_player/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>This is just a picture. Scroll down to try the MIDI player for real.</p>
</div></div><p>I happened upon this midi player for webpages. Will it work here too? <a href="https://cifkao.github.io/html-midi-player/" class="uri">https://cifkao.github.io/html-midi-player/</a></p>
<p>Following the instructions from that website, I am adding this script in the yml for this .qmd file, along with a resources line to make sure the midi file is copied to the docs folder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1">resources: </span>
<span id="cb2-2">  - bluesy_C.mid</span>
<span id="cb2-3">include-before-body:</span>
<span id="cb2-4">  text: |</span>
<span id="cb2-5">    &lt;script src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0"&gt;&lt;/script&gt;</span></code></pre></div>
</details>
</div>
<p>Added an html block that has this code:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb3-1">&lt;midi-player</span>
<span id="cb3-2">  src="bluesy_C.mid"</span>
<span id="cb3-3">  sound-font visualizer="#myVisualizer"&gt;</span>
<span id="cb3-4">&lt;/midi-player&gt;</span>
<span id="cb3-5">&lt;midi-visualizer type="piano-roll" id="myVisualizer"&gt;&lt;/midi-visualizer&gt;</span></code></pre></div>
</details>
</div>
<p>And, it works!</p>
<midi-player src="bluesy_C.mid" sound-font="" visualizer="#myVisualizer">
</midi-player>
<midi-visualizer type="piano-roll" id="myVisualizer"></midi-visualizer>
<hr>
<p>Cool, I have not looked deeply into this at all, so I have no idea what’s behind the sound generation. I’m just curious about what happens if I play a midi file that should have a few different voices. I choose the moon theme from the NES ducktales game. Such a great song.</p>
<midi-player src="the-moon.mid" sound-font="" visualizer="#myVisualizer">
</midi-player>
<midi-visualizer type="piano-roll" id="myVisualizer"></midi-visualizer>
<p>OH YA!!!!!</p>



 ]]></description>
  <category>midiblender</category>
  <category>midi</category>
  <guid>https://homophony.quest/blog/47_2_13_24_midi_player/</guid>
  <pubDate>Tue, 13 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/47_2_13_24_midi_player/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>MIDI composition with {dplyr}, {midiblender}, and {pyramidi}</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/46_2_12_24_dplyr_midi/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"composing music with rstats. dplyr musical notes. tidyverse. hexagons everywhere. 3d. music inside hexagons floating in the universe. musical notes inside the hexagons. cartoon. linocut"</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://homophony.quest/blog/46_2_12_24_dplyr_midi/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Massive modular synthesizer. Eurorack modular synthesizer. Huge synthesizer room, full or modular synthesizers with patch cords connecting everywer. 80s cartoon. Linocut. - dreamshaper</p>
</div></div><p>This morning I added some <a href="">dplyr</a> style functions to <a href="">midiblender</a> for row-by-row, explicit construction of a data frame containing midi information. I’ll provide some examples here, and use this post to try a few compositional goals with the dplyr approach.</p>
<p><a href="https://urswilke.github.io/pyramidi/articles/compose.html">pyramidi</a> also has examples of composition with dplyr syntax that are worth checking out. My approach relies on several pyramidi internal functions, and is pretty similar overall.</p>
<section id="midi-dataframe-construction-with-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="midi-dataframe-construction-with-dplyr">Midi dataframe construction with {dplyr}</h2>
<p>Some of these examples are also in the vignette, <a href="https://www.crumplab.com/midiblender/articles/midi_construct.html">Midi data frame constructors with dplyr</a>.</p>
<p>The following block of code shows an example of systematically creating a midi data frame, on a row-by-row basis. The functions are mostly wrappers to <code>dplyr::add_row</code>, but they have midi variables in them.</p>
<p>Functions that add a row start with “add”, which makes them easy to find with autocomplete while programming. These functions also pass <code>...</code>, which is useful for placing a row <code>.before</code> or <code>.after</code> another row.</p>
<p>This code block writes important meta messages, shows that it is possible to write program_change and control_change messages, and writes a couple notes before ending the track.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(midiblender)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pyramidi)</span>
<span id="cb2-3"></span>
<span id="cb2-4">new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize columns</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-8">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-9">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb2-10">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-12">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_note_on</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_note_off</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print the data frame.</span></span>
<span id="cb2-19">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(new_midi_df)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 17%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">i_track</th>
<th style="text-align: left;">meta</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">numerator</th>
<th style="text-align: right;">denominator</th>
<th style="text-align: right;">clocks_per_click</th>
<th style="text-align: right;">notated_32nd_notes_per_beat</th>
<th style="text-align: right;">program</th>
<th style="text-align: right;">channel</th>
<th style="text-align: right;">control</th>
<th style="text-align: right;">value</th>
<th style="text-align: right;">note</th>
<th style="text-align: right;">velocity</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">track_name</td>
<td style="text-align: left;">My track</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">set_tempo</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5e+05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">time_signature</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">program_change</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">control_change</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">note_on</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">note_off</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">end_of_track</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="pyramidi-object-creation-and-export" class="level2">
<h2 class="anchored" data-anchor-id="pyramidi-object-creation-and-export">Pyramidi object creation and export</h2>
<p>This shows how to take a midi dataframe like the above, and export it to disk as a .mid file.</p>
<p>First, <code>pyramidi::MidiFramer$new()</code> creates a new pyramidi object.</p>
<p>Upon creation, it is possible to update <code>new_pyramidi_object$ticks_per_beat</code> with a new value. I believe the default value is <code>960L</code>, and the code below updates it to a smaller value.</p>
<p>The <code>new_midi_df</code> from above is then updated within the pyramidi object using <code>new_pyramidi_object$mf$midi_frame_unnested$update_unnested_mf(new_midi_df)</code>.</p>
<p>Finally, <code>new_pyramidi_object$mf$write_file("file_name.mid")</code> writes the file to disk.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb3-2">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb3-5">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb3-8">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(new_midi_df)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb3-11">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file_name.mid"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="composing-with-a-wide-data-frame-then-pivoting-to-long" class="level2">
<h2 class="anchored" data-anchor-id="composing-with-a-wide-data-frame-then-pivoting-to-long">Composing with a wide data frame, then pivoting to long</h2>
<p>Midi files writes note_on and note_off messages in succession with time stamps coding relative time since the last message. For composition, it may be convenient to work with a wider data frame.</p>
<p>Here’s an example of using dplyr to create a series of notes over time. The notes are randomly chosen from the vector <code>possible_notes</code>. The rhythm defining when a note occurs is generated by <code>bresenham_euclidean()</code>, which can produce some nice sounding rhythms. The code chunk will generate as many bars as defined in <code>bars</code>, and the shortest note is a 16th note.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb4-4">bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of bars</span></span>
<span id="cb4-5">bar_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of time steps in a bar</span></span>
<span id="cb4-6">note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note duration in ticks</span></span>
<span id="cb4-7">possible_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">66</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">67</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># midi note values to pick</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a tibble to compose notes in time </span></span>
<span id="cb4-10">compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-11">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-12">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-13">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb4-14">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add multiple bars worth of notes</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(bars,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-17">                                            bar_time_steps,</span>
<span id="cb4-18">                                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))),</span>
<span id="cb4-19">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(possible_notes, </span>
<span id="cb4-20">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bar_time_steps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bars, </span>
<span id="cb4-21">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-22">          ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb4-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb4-25">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>note_duration,</span>
<span id="cb4-26">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>note_duration) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep events where a beat occurred</span></span>
<span id="cb4-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) </span>
<span id="cb4-29"></span>
<span id="cb4-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print to show</span></span>
<span id="cb4-31">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(compose_notes))</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">note_id</th>
<th style="text-align: right;">note</th>
<th style="text-align: right;">beat_on</th>
<th style="text-align: right;">note_on</th>
<th style="text-align: right;">note_off</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">216</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">384</td>
<td style="text-align: right;">408</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">432</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">456</td>
<td style="text-align: right;">480</td>
</tr>
<tr class="even">
<td style="text-align: right;">21</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">480</td>
<td style="text-align: right;">504</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>At this point the <code>compose_notes</code> dataframe contains note_on and note_off information in wide format. A quick call to <code>tidyr::pivot_longer</code>, along with subtracting the time stamps to get them into relative time, and we have a dataframe that is nearly ready for export.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> compose_notes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pivot to long</span></span>
<span id="cb5-3">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># relative time</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print to show</span></span>
<span id="cb5-8">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(compose_notes))</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">note_id</th>
<th style="text-align: right;">note</th>
<th style="text-align: right;">beat_on</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">note_on</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">note_off</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">note_on</td>
<td style="text-align: right;">168</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">note_off</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">note_on</td>
<td style="text-align: right;">168</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">note_off</td>
<td style="text-align: right;">24</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now we have a body of midi messages. The last step is to put them into a full-fledged midi dataframe, and export them.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create new midi_df</span></span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add to a new midi df</span></span>
<span id="cb6-4">new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb6-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb6-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb6-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb6-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-14">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add new notes &lt;---------------Adding stuff from compose_notes</span></span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), </span>
<span id="cb6-18">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb6-19">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb6-20">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb6-21">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb6-22">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>()</span>
<span id="cb6-24"></span>
<span id="cb6-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb6-26"></span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb6-28">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb6-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb6-30">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb6-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb6-32">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(new_midi_df)</span>
<span id="cb6-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb6-34">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file_name.mid"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="making-it-less-of-a-wall-of-code" class="level2">
<h2 class="anchored" data-anchor-id="making-it-less-of-a-wall-of-code">Making it less of a wall of code</h2>
<p>I’m not working on this right now. Going with walls of code.</p>
</section>
<section id="frequency-biased-sequences" class="level2">
<h2 class="anchored" data-anchor-id="frequency-biased-sequences">Frequency biased sequences</h2>
<p>I’ve got a project coming up where I will likely need to generate a whole bunch of “musical” sequences with specific kinds of statistical structure. I’m not sure whether I will use the {dplyr} style code for this. This is a note to future self about what it might look like.</p>
<ul>
<li>got something that will work later</li>
<li>need to write functions for creating unequal frequency vectors with specific constraints</li>
<li>Move development on this issue to another castle.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb7-2">bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb7-3">possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb7-4">note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb7-5">possible_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">66</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">67</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)</span>
<span id="cb7-6"></span>
<span id="cb7-7">total_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb7-8">total_beats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>possible_time_steps</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># need to work out some algorithms for unequal frequency distribution generation, these are enough for an example</span></span>
<span id="cb7-11">equal_frequencies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(total_beats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb7-12">half_frequencies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> equal_frequencies <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (equal_frequencies <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> total_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb7-13">most_unequal_frequencies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,(total_notes<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)),(total_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(total_notes<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb7-14"></span>
<span id="cb7-15">note_frequency_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(equal_frequencies,</span>
<span id="cb7-16">                              half_frequencies,</span>
<span id="cb7-17">                              most_unequal_frequencies)</span>
<span id="cb7-18"></span>
<span id="cb7-19">compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-20">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-21">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-22">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb7-23">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1 beat every time_step</span></span>
<span id="cb7-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-27">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(possible_notes),</span>
<span id="cb7-28">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> note_frequency_matrix[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,])),</span>
<span id="cb7-29">          ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-31">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb7-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb7-33">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>note_duration,</span>
<span id="cb7-34">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>note_duration) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb7-37">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb7-39"></span>
<span id="cb7-40"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add to a new midi df</span></span>
<span id="cb7-41">new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb7-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb7-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb7-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb7-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb7-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb7-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-51">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-53">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use dplyr::add_row to add a bunch of notes</span></span>
<span id="cb7-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), </span>
<span id="cb7-55">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb7-56">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb7-57">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb7-58">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb7-59">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>()</span>
<span id="cb7-61"></span>
<span id="cb7-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb7-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb7-64">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb7-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb7-66">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb7-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb7-68">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(new_midi_df)</span>
<span id="cb7-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb7-70">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"most_unequal.mid"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="bar-blues-sequence" class="level2">
<h2 class="anchored" data-anchor-id="bar-blues-sequence">12-bar blues sequence</h2>
<p>I like a good blues scale. Undoubtedly, whatever happens next won’t be bluesy, but that’s ok.</p>
<p>Algorithm components</p>
<ol type="1">
<li>Sample notes from a blues scale</li>
<li>Eavery bar, randomly sample a euclidean rhythm to fill the bar</li>
<li>randomly assign notes to the beats in the euclidean rhythm</li>
<li>Create a few tracks of this.</li>
<li>try shifting chords, do 12 bar blues</li>
</ol>
<p>Got it working, nice</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop for each track</span></span>
<span id="cb8-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb8-4">  </span>
<span id="cb8-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb8-6">  bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb8-7">  possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb8-8">  note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb8-9">  possible_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">66</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">67</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)</span>
<span id="cb8-10">  </span>
<span id="cb8-11">  key_vector <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each=</span>possible_time_steps),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb8-12">  </span>
<span id="cb8-13">  compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb8-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb8-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()</span>
<span id="cb8-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use euclidean rhythm</span></span>
<span id="cb8-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb8-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(</span>
<span id="cb8-24">        bars,</span>
<span id="cb8-25">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-26">                            possible_time_steps,</span>
<span id="cb8-27">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-28">      )),</span>
<span id="cb8-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(possible_notes,</span>
<span id="cb8-30">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> possible_time_steps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bars,</span>
<span id="cb8-31">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> key_vector</span>
<span id="cb8-32">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb8-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb8-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb8-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> note_duration,</span>
<span id="cb8-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> note_duration</span>
<span id="cb8-39">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-40">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb8-42">    tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),</span>
<span id="cb8-43">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,</span>
<span id="cb8-44">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-45">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb8-46">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######################</span></span>
<span id="cb8-47">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># End composition </span></span>
<span id="cb8-48">  </span>
<span id="cb8-49">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#######################</span></span>
<span id="cb8-50">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add composition to a new midi df</span></span>
<span id="cb8-51">  new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb8-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-54">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb8-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb8-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb8-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb8-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb8-59">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-60">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-61">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-62">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composition added here</span></span>
<span id="cb8-64">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb8-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb8-66">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb8-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb8-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb8-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb8-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb8-71">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-72">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-73">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> t) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set current track number</span></span>
<span id="cb8-74">  </span>
<span id="cb8-75">  all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(all_tracks,new_midi_df)</span>
<span id="cb8-76">  </span>
<span id="cb8-77">}</span>
<span id="cb8-78"></span>
<span id="cb8-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb8-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb8-81">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb8-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb8-83">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb8-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb8-85">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(all_tracks)</span>
<span id="cb8-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb8-87">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bluesy_A.mid"</span>)</span></code></pre></div>
</details>
</div>
<p><audio controls=""> <source src="bluesy_A_ableton_01.mp3" type="audio/wav"> </audio></p>
<p>I put three midi tracks into ableton, added synth voices and drums, and that’s what it sounds like.</p>
<p>Hmmm, the dplyr style worked out. I didn’t think it would be so easy to get a 12-bar blues thing going. It still sounds like a computer made it, but a computer did make it, so that’s fair.</p>
<hr>
<p>Adding parameters per track in a list.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(midiblender)</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pyramidi)</span>
<span id="cb9-4"></span>
<span id="cb9-5">all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note parameters</span></span>
<span id="cb9-8">  bars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb9-9">  possible_time_steps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb9-10">  note_duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb9-11">  </span>
<span id="cb9-12">  track_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_1_bass =</span></span>
<span id="cb9-13">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb9-14">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)), </span>
<span id="cb9-15">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb9-16">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb9-17">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb9-18">                           ),</span>
<span id="cb9-19">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_2_mid =</span></span>
<span id="cb9-20">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb9-21">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)), </span>
<span id="cb9-22">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb9-23">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb9-24">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb9-25">                          ),</span>
<span id="cb9-26">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">track_3_mid =</span></span>
<span id="cb9-27">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">possible_notes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#1     2     3  4     5     6     7  8 </span></span>
<span id="cb9-28">                                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), </span>
<span id="cb9-29">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key_vector =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb9-30">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> possible_time_steps), </span>
<span id="cb9-31">                                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb9-32">                          )</span>
<span id="cb9-33">  )</span>
<span id="cb9-34">                       </span>
<span id="cb9-35">                           </span>
<span id="cb9-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop for each track</span></span>
<span id="cb9-37"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb9-38">  </span>
<span id="cb9-39">  compose_notes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb9-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb9-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb9-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb9-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb9-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>()</span>
<span id="cb9-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use euclidean rhythm</span></span>
<span id="cb9-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-48">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb9-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beat_on =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(</span>
<span id="cb9-50">        bars,</span>
<span id="cb9-51">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bresenham_euclidean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb9-52">                            possible_time_steps,</span>
<span id="cb9-53">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-54">      )),</span>
<span id="cb9-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>possible_notes,</span>
<span id="cb9-56">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> possible_time_steps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bars,</span>
<span id="cb9-57">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> track_params[[t]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>key_vector</span>
<span id="cb9-58">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-59">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle note times</span></span>
<span id="cb9-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb9-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb9-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_on =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> note_duration,</span>
<span id="cb9-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note_off =</span> note_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> note_duration</span>
<span id="cb9-65">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-66">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(beat_on <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-67">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pivot to long</span></span>
<span id="cb9-68">    tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_on"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"note_off"</span>),</span>
<span id="cb9-69">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>,</span>
<span id="cb9-70">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-71">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb9-72">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######################</span></span>
<span id="cb9-73">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># End composition </span></span>
<span id="cb9-74">  </span>
<span id="cb9-75">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#######################</span></span>
<span id="cb9-76">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## add composition to a new midi df</span></span>
<span id="cb9-77">  new_midi_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_empty_midi_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialize</span></span>
<span id="cb9-78">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_track_name</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My track"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-79">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_tempo</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tempo =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-80">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_time_sig</span>(</span>
<span id="cb9-81">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numerator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb9-82">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb9-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clocks_per_click =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb9-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notated_32nd_notes_per_beat =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb9-85">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-86">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_program_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">program =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-87">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">channel =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-88">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_control_change</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-89">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composition added here</span></span>
<span id="cb9-90">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_row</span>(</span>
<span id="cb9-91">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb9-92">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(compose_notes)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb9-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">note =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>note,</span>
<span id="cb9-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type,</span>
<span id="cb9-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> compose_notes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time,</span>
<span id="cb9-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">velocity =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb9-97">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-98">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_meta_end_of_track</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-99">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i_track =</span> t) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set current track number</span></span>
<span id="cb9-100">  </span>
<span id="cb9-101">  all_tracks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(all_tracks,new_midi_df)</span>
<span id="cb9-102">  </span>
<span id="cb9-103">}</span>
<span id="cb9-104"></span>
<span id="cb9-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#write midi</span></span>
<span id="cb9-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Initialize new pyramidi object</span></span>
<span id="cb9-107">new_pyramidi_object <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pyramidi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>MidiFramer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new</span>()</span>
<span id="cb9-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update ticks per beat</span></span>
<span id="cb9-109">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ticks_per_beat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>L</span>
<span id="cb9-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update object with new midi df</span></span>
<span id="cb9-111">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midi_frame_unnested<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_unnested_mf</span>(all_tracks)</span>
<span id="cb9-112"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to midi file</span></span>
<span id="cb9-113">new_pyramidi_object<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bluesy_C.mid"</span>)</span></code></pre></div>
</details>
</div>


</section>

 ]]></description>
  <category>midiblender</category>
  <category>pyramidi</category>
  <category>rstats</category>
  <category>dplyr</category>
  <category>midi composition</category>
  <guid>https://homophony.quest/blog/46_2_12_24_dplyr_midi/</guid>
  <pubDate>Mon, 12 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/46_2_12_24_dplyr_midi/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Eurorack notes to self</title>
  <dc:creator>Matt Crump</dc:creator>
  <link>https://homophony.quest/blog/45_2_11_24_eurorack/</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> diffusers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DiffusionPipeline</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_seed</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ssl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-8">ssl._create_default_https_context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ssl._create_unverified_context</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#locate library</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model_id = "./stable-diffusion-v1-5"</span></span>
<span id="cb1-12">model_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dreamshaper-xl-turbo"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionPipeline.from_pretrained(</span>
<span id="cb1-15">    pretrained_model_name_or_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../../../bigFiles/huggingface/dreamshaper-xl-turbo/"</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18">pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline.to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recommended if your computer has &lt; 64 GB of RAM</span></span>
<span id="cb1-21">pipeline.enable_attention_slicing(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb1-22"></span>
<span id="cb1-23">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Massive modular synthesizer. Eurorack modular synthesizer. Huge synthesizer room, full or modular synthesizers with patch cords connecting everywer. 80s cartoon. Linocut."</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>):</span>
<span id="cb1-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]:</span>
<span id="cb1-27">    seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb1-28">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-29">    set_seed(seed)</span>
<span id="cb1-30">    </span>
<span id="cb1-31">    image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pipeline(prompt,height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,num_images_per_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num_inference_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_steps)</span>
<span id="cb1-32">    </span>
<span id="cb1-33">    image_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/synth_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpeg"</span></span>
<span id="cb1-34">    </span>
<span id="cb1-35">    image_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image.images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].save(image_name.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(seed,num_steps))</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://homophony.quest/blog/45_2_11_24_eurorack/cover.jpg" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%"></p>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Massive modular synthesizer. Eurorack modular synthesizer. Huge synthesizer room, full or modular synthesizers with patch cords connecting everywer. 80s cartoon. Linocut. - dreamshaper</p>
</div></div><p>Notes to self about eurorack stuff.</p>
<section id="programmable-eurorack-modules" class="level2">
<h2 class="anchored" data-anchor-id="programmable-eurorack-modules">Programmable Eurorack Modules</h2>
<p>I very briefly <a href="https://www.crumplab.com/blog/older_9999_7_28_20_OC/">tried to program ornaments and crime one time</a>. But that’s about it. I could see becoming interested in putting ideas from {midiblender}, and other ideas, into eurorack in different ways.</p>
<ul>
<li><p>older post on mod wiggler about open source programmable eurorack modules <a href="https://modwiggler.com/forum/viewtopic.php?t=220061" class="uri">https://modwiggler.com/forum/viewtopic.php?t=220061</a></p></li>
<li><p>a useful list of programmable audio platforms <a href="https://blog.macieksypniewski.com/2019/07/08/programmable-audio-platforms/" class="uri">https://blog.macieksypniewski.com/2019/07/08/programmable-audio-platforms/</a></p></li>
<li><p>Bela pepper <a href="https://shop.bela.io/collections/modular/products/pepper" class="uri">https://shop.bela.io/collections/modular/products/pepper</a></p></li>
<li><p><a href="https://monome.org/docs/">Monome</a> has some interesting stuff</p></li>
<li><p><a href="https://allensynthesis.co.uk/modules/europi.html">EuroPi</a> Based on raspberry pi pico I think</p></li>
<li><p><a href="https://www.expert-sleepers.co.uk/es8.html">Es8</a> or <a href="https://www.expert-sleepers.co.uk/es9.html">ES-9</a> USB-audio interface…I could use one of these in general I think…hmm.</p></li>
</ul>
</section>
<section id="eurorack-composition-ideas" class="level2">
<h2 class="anchored" data-anchor-id="eurorack-composition-ideas">Eurorack composition ideas</h2>
<p>I don’t really want to mess with my computer while messing with eurorack at the same time, as a general rule.</p>
<section id="easy-can-do-right-now" class="level3">
<h3 class="anchored" data-anchor-id="easy-can-do-right-now">Easy can do right now</h3>
<ol type="1">
<li>Use {midiblender} to compose MIDI files with some things I want, play them through hermod. This gives me 8-voices. Probably the easiest thing I can do right now. Benefits are that the midi files are pre-packaged, and I shouldn’t have to worry about any latency or anything like that.</li>
</ol>
<ul>
<li>I like this pattern for a bunch of reasons. I focus on some compositional ideas outside of eurorack. Generate all the midi based on the compositional ideas…which basically acts as CV and gate sources. Hook it all up to voices on, and wreck the whole thing as much as possible by turning knobs during playback. Sounds fun. Feels a little bit locked in to the compositional direction from the midi files, but I guess that’s the whole point of composing something.</li>
</ul>
<ol start="2" type="1">
<li>This is somewhere in the middle, but I wonder about a way to rapidly scroll through a bunch of midi files, while they are playing, kind of like how one might scroll through a wavetable and hear all of the notes. If I had banks of possible midi files to play, and could easily scroll them, that would be fun. hmmmm.</li>
</ol>
</section>
<section id="longer-term-cant-do-right-now" class="level3">
<h3 class="anchored" data-anchor-id="longer-term-cant-do-right-now">longer term can’t do right now</h3>
<ol start="2" type="1">
<li>Have a module (or computer program) that can accumulate CV or midi from a live performance, crunch the probabilities at various levels (e.g., into various markov chain ideas, or other weird stuff), and do interesting generative sequencing based off of the live performance statistics.</li>
</ol>


</section>
</section>

 ]]></description>
  <category>midiblender</category>
  <category>eurorack</category>
  <category>programmable eurorack</category>
  <category>composition</category>
  <guid>https://homophony.quest/blog/45_2_11_24_eurorack/</guid>
  <pubDate>Sun, 11 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://homophony.quest/blog/45_2_11_24_eurorack/cover.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
